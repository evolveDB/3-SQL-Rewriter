time used(s):8.717, index: 0, origin_cost: 7603.669921875, rewrite_cost: 7603.669921875, origin: SELECT MIN(chn.name) AS uncredited_voiced_character, MIN(t.title) AS russian_movie FROM char_name AS chn, cast_info AS ci, company_name AS cn, company_type AS ct, movie_companies AS mc, role_type AS rt, title AS t WHERE ci.note LIKE '%(voice)%' AND ci.note LIKE '%(uncredited)%' AND cn.country_code = '[ru]' AND rt.role = 'actor' AND t.production_year > 2005 AND t.id = mc.movie_id AND t.id = ci.movie_id AND ci.movie_id = mc.movie_id AND chn.id = ci.person_role_id AND rt.id = ci.role_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id;, rewrite: SELECT MIN(chn.name) AS uncredited_voiced_character, MIN(t.title) AS russian_movie FROM char_name AS chn, cast_info AS ci, company_name AS cn, company_type AS ct, movie_companies AS mc, role_type AS rt, title AS t WHERE ci.note LIKE '%(voice)%' AND ci.note LIKE '%(uncredited)%' AND cn.country_code = '[ru]' AND rt.role = 'actor' AND t.production_year > 2005 AND t.id = mc.movie_id AND t.id = ci.movie_id AND ci.movie_id = mc.movie_id AND chn.id = ci.person_role_id AND rt.id = ci.role_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id;
time used(s):7.367, index: 1, origin_cost: 10118.8798828125, rewrite_cost: 10118.8798828125, origin: SELECT MIN(chn.name) AS cname, MIN(t.title) AS russian_mov_with_actor_producer FROM char_name AS chn, cast_info AS ci, company_name AS cn, company_type AS ct, movie_companies AS mc, role_type AS rt, title AS t WHERE ci.note LIKE '%(producer)%' AND cn.country_code = '[ru]' AND rt.role = 'actor' AND t.production_year > 2010 AND t.id = mc.movie_id AND t.id = ci.movie_id AND ci.movie_id = mc.movie_id AND chn.id = ci.person_role_id AND rt.id = ci.role_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id;, rewrite: SELECT MIN(chn.name) AS cname, MIN(t.title) AS russian_mov_with_actor_producer FROM char_name AS chn, cast_info AS ci, company_name AS cn, company_type AS ct, movie_companies AS mc, role_type AS rt, title AS t WHERE ci.note LIKE '%(producer)%' AND cn.country_code = '[ru]' AND rt.role = 'actor' AND t.production_year > 2010 AND t.id = mc.movie_id AND t.id = ci.movie_id AND ci.movie_id = mc.movie_id AND chn.id = ci.person_role_id AND rt.id = ci.role_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id;
time used(s):7.364, index: 2, origin_cost: 101158.203125, rewrite_cost: 101158.203125, origin: SELECT MIN(chn.name) AS cname, MIN(t.title) AS movie_with_american_producer FROM char_name AS chn, cast_info AS ci, company_name AS cn, company_type AS ct, movie_companies AS mc, role_type AS rt, title AS t WHERE ci.note LIKE '%(producer)%' AND cn.country_code = '[us]' AND t.production_year > 1990 AND t.id = mc.movie_id AND t.id = ci.movie_id AND ci.movie_id = mc.movie_id AND chn.id = ci.person_role_id AND rt.id = ci.role_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id;, rewrite: SELECT MIN(chn.name) AS cname, MIN(t.title) AS movie_with_american_producer FROM char_name AS chn, cast_info AS ci, company_name AS cn, company_type AS ct, movie_companies AS mc, role_type AS rt, title AS t WHERE ci.note LIKE '%(producer)%' AND cn.country_code = '[us]' AND t.production_year > 1990 AND t.id = mc.movie_id AND t.id = ci.movie_id AND ci.movie_id = mc.movie_id AND chn.id = ci.person_role_id AND rt.id = ci.role_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id;
time used(s):3.712, index: 3, origin_cost: 7740.2998046875, rewrite_cost: 7740.10986328125, origin: SELECT MIN(cn.name) AS from_company, MIN(lt.link) AS movie_link_type, MIN(t.title) AS non_polish_sequel_movie FROM company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND t.production_year BETWEEN 1950 AND 2000 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`company_name662`.`name`) AS `from_company`, MIN(`link_type50`.`link`) AS `movie_link_type`, MIN(`title712`.`title`) AS `non_polish_sequel_movie` FROM `company_name` AS `company_name662`, `company_type` AS `company_type662`, `keyword` AS `keyword50`, `link_type` AS `link_type50`, `movie_companies` AS `movie_companies662`, `movie_keyword` AS `movie_keyword50`, `movie_link` AS `movie_link50`, `title` AS `title712` WHERE `company_name662`.`country_code` <> '[pl]' AND (`company_name662`.`name` LIKE '%Film%' OR `company_name662`.`name` LIKE '%Warner%') AND (`company_type662`.`kind` = 'production companies' AND `keyword50`.`keyword` = 'sequel') AND (`link_type50`.`link` LIKE '%follow%' AND `movie_companies662`.`note` IS NULL AND (`title712`.`production_year` >= 1950 AND (`title712`.`production_year` <= 2000 AND `link_type50`.`id` = `movie_link50`.`link_type_id`))) AND (`movie_link50`.`movie_id` = `title712`.`id` AND `title712`.`id` = `movie_keyword50`.`movie_id` AND (`movie_keyword50`.`keyword_id` = `keyword50`.`id` AND `title712`.`id` = `movie_companies662`.`movie_id`) AND (`movie_companies662`.`company_type_id` = `company_type662`.`id` AND `movie_companies662`.`company_id` = `company_name662`.`id` AND (`movie_link50`.`movie_id` = `movie_keyword50`.`movie_id` AND (`movie_link50`.`movie_id` = `movie_companies662`.`movie_id` AND `movie_keyword50`.`movie_id` = `movie_companies662`.`movie_id`))))
time used(s):5.373, index: 4, origin_cost: 6728.66015625, rewrite_cost: 6728.66015625, origin: SELECT MIN(cn.name) AS from_company, MIN(lt.link) AS movie_link_type, MIN(t.title) AS sequel_movie FROM company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follows%' AND mc.note IS NULL AND t.production_year = 1998 AND t.title LIKE '%Money%' AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id;, rewrite: SELECT MIN(cn.name) AS from_company, MIN(lt.link) AS movie_link_type, MIN(t.title) AS sequel_movie FROM company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follows%' AND mc.note IS NULL AND t.production_year = 1998 AND t.title LIKE '%Money%' AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id;
time used(s):7.685, index: 5, origin_cost: 207768.796875, rewrite_cost: 207768.796875, origin: SELECT MIN(cn.name) AS from_company, MIN(mc.note) AS production_note, MIN(t.title) AS movie_based_on_book FROM company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cn.country_code !='[pl]' AND (cn.name LIKE '20th Century Fox%' OR cn.name LIKE 'Twentieth Century Fox%') AND ct.kind != 'production companies' AND ct.kind IS NOT NULL AND k.keyword IN ('sequel', 'revenge', 'based-on-novel') AND mc.note IS NOT NULL AND t.production_year > 1950 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id;, rewrite: SELECT MIN(cn.name) AS from_company, MIN(mc.note) AS production_note, MIN(t.title) AS movie_based_on_book FROM company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cn.country_code !='[pl]' AND (cn.name LIKE '20th Century Fox%' OR cn.name LIKE 'Twentieth Century Fox%') AND ct.kind != 'production companies' AND ct.kind IS NOT NULL AND k.keyword IN ('sequel', 'revenge', 'based-on-novel') AND mc.note IS NOT NULL AND t.production_year > 1950 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id;
time used(s):6.697, index: 6, origin_cost: 446173.78125, rewrite_cost: 434388.15625, origin: SELECT MIN(cn.name) AS from_company, MIN(mc.note) AS production_note, MIN(t.title) AS movie_based_on_book FROM company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cn.country_code !='[pl]' AND ct.kind != 'production companies' AND ct.kind IS NOT NULL AND k.keyword IN ('sequel', 'revenge', 'based-on-novel') AND mc.note IS NOT NULL AND t.production_year > 1950 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`company_name1132`.`name`) AS `from_company`, MIN(`movie_companies1132`.`note`) AS `production_note`, MIN(`title1234`.`title`) AS `movie_based_on_book` FROM `company_name` AS `company_name1132`, `company_type` AS `company_type1132`, `keyword` AS `keyword520`, `link_type` AS `link_type520`, `movie_companies` AS `movie_companies1132`, `movie_keyword` AS `movie_keyword520`, `movie_link` AS `movie_link520`, `title` AS `title1234` WHERE `company_name1132`.`country_code` <> '[pl]' AND `company_type1132`.`kind` <> 'production companies' AND (`company_type1132`.`kind` IS NOT NULL AND (`keyword520`.`keyword` = 'sequel' OR `keyword520`.`keyword` = 'revenge' OR `keyword520`.`keyword` = 'based-on-novel')) AND (`movie_companies1132`.`note` IS NOT NULL AND `title1234`.`production_year` > 1950 AND (`link_type520`.`id` = `movie_link520`.`link_type_id` AND `movie_link520`.`movie_id` = `title1234`.`id`)) AND (`title1234`.`id` = `movie_keyword520`.`movie_id` AND `movie_keyword520`.`keyword_id` = `keyword520`.`id` AND (`title1234`.`id` = `movie_companies1132`.`movie_id` AND `movie_companies1132`.`company_type_id` = `company_type1132`.`id`) AND (`movie_companies1132`.`company_id` = `company_name1132`.`id` AND `movie_link520`.`movie_id` = `movie_keyword520`.`movie_id` AND (`movie_link520`.`movie_id` = `movie_companies1132`.`movie_id` AND `movie_keyword520`.`movie_id` = `movie_companies1132`.`movie_id`)))
time used(s):9.713, index: 7, origin_cost: 923567.5, rewrite_cost: 923563.625, origin: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS drama_horror_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, title AS t WHERE cn.country_code = '[us]' AND ct.kind = 'production companies' AND it1.info = 'genres' AND it2.info = 'rating' AND mi.info IN ('Drama', 'Horror') AND mi_idx.info > '8.0' AND t.production_year BETWEEN 2005 AND 2008 AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND mi.info_type_id = it1.id AND mi_idx.info_type_id = it2.id AND t.id = mc.movie_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND mc.movie_id = mi.movie_id AND mc.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`t4091`.`name`) AS `movie_company`, MIN(`t4096`.`info`) AS `rating`, MIN(`t4097`.`title`) AS `drama_horror_movie` FROM (SELECT * FROM `company_name` WHERE `country_code` = '[us]') AS `t4091` CROSS JOIN (SELECT * FROM `company_type` WHERE `kind` = 'production companies') AS `t4092` CROSS JOIN (SELECT * FROM `info_type` WHERE `info` = 'genres') AS `t4093` CROSS JOIN (SELECT * FROM `info_type` WHERE `info` = 'rating') AS `t4094` INNER JOIN `movie_companies` AS `movie_companies1139` ON `t4092`.`id` = `movie_companies1139`.`company_type_id` AND `t4091`.`id` = `movie_companies1139`.`company_id` INNER JOIN (SELECT * FROM `movie_info` WHERE `info` IN ('Drama', 'Horror')) AS `t4095` ON `t4093`.`id` = `t4095`.`info_type_id` AND `movie_companies1139`.`movie_id` = `t4095`.`movie_id` INNER JOIN (SELECT * FROM `movie_info_idx` WHERE `info` > '8.0') AS `t4096` ON `t4094`.`id` = `t4096`.`info_type_id` AND `movie_companies1139`.`movie_id` = `t4096`.`movie_id` AND `t4095`.`movie_id` = `t4096`.`movie_id` INNER JOIN (SELECT * FROM `title` WHERE `production_year` >= 2005 AND `production_year` <= 2008) AS `t4097` ON `t4095`.`movie_id` = `t4097`.`id` AND `t4096`.`movie_id` = `t4097`.`id` AND `movie_companies1139`.`movie_id` = `t4097`.`id`
time used(s):10.104, index: 8, origin_cost: 1258731.25, rewrite_cost: 1077293.75, origin: SELECT MIN(mi.info) AS budget, MIN(t.title) AS unsuccsessful_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, title AS t WHERE cn.country_code ='[us]' AND ct.kind IS NOT NULL AND (ct.kind ='production companies' OR ct.kind = 'distributors') AND it1.info ='budget' AND it2.info ='bottom 10 rank' AND t.production_year >2000 AND (t.title LIKE 'Birdemic%' OR t.title LIKE '%Movie%') AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND mi.info_type_id = it1.id AND mi_idx.info_type_id = it2.id AND t.id = mc.movie_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND mc.movie_id = mi.movie_id AND mc.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info405`.`info`) AS `budget`, MIN(`t7947`.`title`) AS `unsuccsessful_movie` FROM (SELECT * FROM `company_name` WHERE `country_code` = '[us]') AS `t7943` CROSS JOIN (SELECT * FROM `company_type` WHERE `kind` IN ('distributors', 'production companies')) AS `t7944` CROSS JOIN (SELECT * FROM `info_type` WHERE `info` = 'budget') AS `t7945` CROSS JOIN (SELECT * FROM `info_type` WHERE `info` = 'bottom 10 rank') AS `t7946` INNER JOIN `movie_companies` AS `movie_companies1539` ON `t7944`.`id` = `movie_companies1539`.`company_type_id` AND `t7943`.`id` = `movie_companies1539`.`company_id` INNER JOIN `movie_info` AS `movie_info405` ON `t7945`.`id` = `movie_info405`.`info_type_id` AND `movie_companies1539`.`movie_id` = `movie_info405`.`movie_id` INNER JOIN `movie_info_idx` AS `movie_info_idx405` ON `t7946`.`id` = `movie_info_idx405`.`info_type_id` AND `movie_companies1539`.`movie_id` = `movie_info_idx405`.`movie_id` AND `movie_info405`.`movie_id` = `movie_info_idx405`.`movie_id` INNER JOIN (SELECT * FROM `title` WHERE `production_year` > 2000 AND (`title` LIKE 'Birdemic%' OR `title` LIKE '%Movie%')) AS `t7947` ON `movie_info405`.`movie_id` = `t7947`.`id` AND `movie_info_idx405`.`movie_id` = `t7947`.`id` AND `movie_companies1539`.`movie_id` = `t7947`.`id`
time used(s):11.14, index: 9, origin_cost: 924325.3125, rewrite_cost: 924321.4375, origin: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS mainstream_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, title AS t WHERE cn.country_code = '[us]' AND ct.kind = 'production companies' AND it1.info = 'genres' AND it2.info = 'rating' AND mi.info IN ('Drama', 'Horror', 'Western', 'Family') AND mi_idx.info > '7.0' AND t.production_year BETWEEN 2000 AND 2010 AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND mi.info_type_id = it1.id AND mi_idx.info_type_id = it2.id AND t.id = mc.movie_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND mc.movie_id = mi.movie_id AND mc.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`t8009`.`name`) AS `movie_company`, MIN(`t8014`.`info`) AS `rating`, MIN(`t8015`.`title`) AS `mainstream_movie` FROM (SELECT * FROM `company_name` WHERE `country_code` = '[us]') AS `t8009` CROSS JOIN (SELECT * FROM `company_type` WHERE `kind` = 'production companies') AS `t8010` CROSS JOIN (SELECT * FROM `info_type` WHERE `info` = 'genres') AS `t8011` CROSS JOIN (SELECT * FROM `info_type` WHERE `info` = 'rating') AS `t8012` INNER JOIN `movie_companies` AS `movie_companies1547` ON `t8010`.`id` = `movie_companies1547`.`company_type_id` AND `t8009`.`id` = `movie_companies1547`.`company_id` INNER JOIN (SELECT * FROM `movie_info` WHERE `info` IN ('Drama', 'Family', 'Horror', 'Western')) AS `t8013` ON `t8011`.`id` = `t8013`.`info_type_id` AND `movie_companies1547`.`movie_id` = `t8013`.`movie_id` INNER JOIN (SELECT * FROM `movie_info_idx` WHERE `info` > '7.0') AS `t8014` ON `t8012`.`id` = `t8014`.`info_type_id` AND `movie_companies1547`.`movie_id` = `t8014`.`movie_id` AND `t8013`.`movie_id` = `t8014`.`movie_id` INNER JOIN (SELECT * FROM `title` WHERE `production_year` >= 2000 AND `production_year` <= 2010) AS `t8015` ON `t8013`.`movie_id` = `t8015`.`id` AND `t8014`.`movie_id` = `t8015`.`id` AND `movie_companies1547`.`movie_id` = `t8015`.`id`
time used(s):9.137, index: 10, origin_cost: 1379243.125, rewrite_cost: 1379243.125, origin: SELECT MIN(mi.info) AS release_date, MIN(miidx.info) AS rating, MIN(t.title) AS german_movie FROM company_name AS cn, company_type AS ct, info_type AS it, info_type AS it2, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS miidx, title AS t WHERE cn.country_code ='[de]' AND ct.kind ='production companies' AND it.info ='rating' AND it2.info ='release dates' AND kt.kind ='movie' AND mi.movie_id = t.id AND it2.id = mi.info_type_id AND kt.id = t.kind_id AND mc.movie_id = t.id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND miidx.movie_id = t.id AND it.id = miidx.info_type_id AND mi.movie_id = miidx.movie_id AND mi.movie_id = mc.movie_id AND miidx.movie_id = mc.movie_id;, rewrite: SELECT MIN(mi.info) AS release_date, MIN(miidx.info) AS rating, MIN(t.title) AS german_movie FROM company_name AS cn, company_type AS ct, info_type AS it, info_type AS it2, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS miidx, title AS t WHERE cn.country_code ='[de]' AND ct.kind ='production companies' AND it.info ='rating' AND it2.info ='release dates' AND kt.kind ='movie' AND mi.movie_id = t.id AND it2.id = mi.info_type_id AND kt.id = t.kind_id AND mc.movie_id = t.id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND miidx.movie_id = t.id AND it.id = miidx.info_type_id AND mi.movie_id = miidx.movie_id AND mi.movie_id = mc.movie_id AND miidx.movie_id = mc.movie_id;
time used(s):8.724, index: 11, origin_cost: 780370.8125, rewrite_cost: 780370.8125, origin: SELECT MIN(cn.name) AS producing_company, MIN(miidx.info) AS rating, MIN(t.title) AS movie_about_winning FROM company_name AS cn, company_type AS ct, info_type AS it, info_type AS it2, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS miidx, title AS t WHERE cn.country_code ='[us]' AND ct.kind ='production companies' AND it.info ='rating' AND it2.info ='release dates' AND kt.kind ='movie' AND t.title != '' AND (t.title LIKE '%Champion%' OR t.title LIKE '%Loser%') AND mi.movie_id = t.id AND it2.id = mi.info_type_id AND kt.id = t.kind_id AND mc.movie_id = t.id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND miidx.movie_id = t.id AND it.id = miidx.info_type_id AND mi.movie_id = miidx.movie_id AND mi.movie_id = mc.movie_id AND miidx.movie_id = mc.movie_id;, rewrite: SELECT MIN(cn.name) AS producing_company, MIN(miidx.info) AS rating, MIN(t.title) AS movie_about_winning FROM company_name AS cn, company_type AS ct, info_type AS it, info_type AS it2, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS miidx, title AS t WHERE cn.country_code ='[us]' AND ct.kind ='production companies' AND it.info ='rating' AND it2.info ='release dates' AND kt.kind ='movie' AND t.title != '' AND (t.title LIKE '%Champion%' OR t.title LIKE '%Loser%') AND mi.movie_id = t.id AND it2.id = mi.info_type_id AND kt.id = t.kind_id AND mc.movie_id = t.id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND miidx.movie_id = t.id AND it.id = miidx.info_type_id AND mi.movie_id = miidx.movie_id AND mi.movie_id = mc.movie_id AND miidx.movie_id = mc.movie_id;
time used(s):9.153, index: 12, origin_cost: 780370.8125, rewrite_cost: 780370.8125, origin: SELECT MIN(cn.name) AS producing_company, MIN(miidx.info) AS rating, MIN(t.title) AS movie_about_winning FROM company_name AS cn, company_type AS ct, info_type AS it, info_type AS it2, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS miidx, title AS t WHERE cn.country_code ='[us]' AND ct.kind ='production companies' AND it.info ='rating' AND it2.info ='release dates' AND kt.kind ='movie' AND t.title != '' AND (t.title LIKE 'Champion%' OR t.title LIKE 'Loser%') AND mi.movie_id = t.id AND it2.id = mi.info_type_id AND kt.id = t.kind_id AND mc.movie_id = t.id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND miidx.movie_id = t.id AND it.id = miidx.info_type_id AND mi.movie_id = miidx.movie_id AND mi.movie_id = mc.movie_id AND miidx.movie_id = mc.movie_id;, rewrite: SELECT MIN(cn.name) AS producing_company, MIN(miidx.info) AS rating, MIN(t.title) AS movie_about_winning FROM company_name AS cn, company_type AS ct, info_type AS it, info_type AS it2, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS miidx, title AS t WHERE cn.country_code ='[us]' AND ct.kind ='production companies' AND it.info ='rating' AND it2.info ='release dates' AND kt.kind ='movie' AND t.title != '' AND (t.title LIKE 'Champion%' OR t.title LIKE 'Loser%') AND mi.movie_id = t.id AND it2.id = mi.info_type_id AND kt.id = t.kind_id AND mc.movie_id = t.id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND miidx.movie_id = t.id AND it.id = miidx.info_type_id AND mi.movie_id = miidx.movie_id AND mi.movie_id = mc.movie_id AND miidx.movie_id = mc.movie_id;
time used(s):8.522, index: 13, origin_cost: 1379243.125, rewrite_cost: 1379243.125, origin: SELECT MIN(cn.name) AS producing_company, MIN(miidx.info) AS rating, MIN(t.title) AS movie FROM company_name AS cn, company_type AS ct, info_type AS it, info_type AS it2, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS miidx, title AS t WHERE cn.country_code ='[us]' AND ct.kind ='production companies' AND it.info ='rating' AND it2.info ='release dates' AND kt.kind ='movie' AND mi.movie_id = t.id AND it2.id = mi.info_type_id AND kt.id = t.kind_id AND mc.movie_id = t.id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND miidx.movie_id = t.id AND it.id = miidx.info_type_id AND mi.movie_id = miidx.movie_id AND mi.movie_id = mc.movie_id AND miidx.movie_id = mc.movie_id;, rewrite: SELECT MIN(cn.name) AS producing_company, MIN(miidx.info) AS rating, MIN(t.title) AS movie FROM company_name AS cn, company_type AS ct, info_type AS it, info_type AS it2, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS miidx, title AS t WHERE cn.country_code ='[us]' AND ct.kind ='production companies' AND it.info ='rating' AND it2.info ='release dates' AND kt.kind ='movie' AND mi.movie_id = t.id AND it2.id = mi.info_type_id AND kt.id = t.kind_id AND mc.movie_id = t.id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND miidx.movie_id = t.id AND it.id = miidx.info_type_id AND mi.movie_id = miidx.movie_id AND mi.movie_id = mc.movie_id AND miidx.movie_id = mc.movie_id;
time used(s):8.897, index: 14, origin_cost: 919692.625, rewrite_cost: 919692.625, origin: SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS northern_dark_movie FROM info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind = 'movie' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info < '8.5' AND t.production_year > 2010 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;, rewrite: SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS northern_dark_movie FROM info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind = 'movie' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info < '8.5' AND t.production_year > 2010 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;
time used(s):9.824, index: 15, origin_cost: 422118.1875, rewrite_cost: 422118.1875, origin: SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS western_dark_production FROM info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title') AND kt.kind = 'movie' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info > '6.0' AND t.production_year > 2010 AND (t.title LIKE '%murder%' OR t.title LIKE '%Murder%' OR t.title LIKE '%Mord%') AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;, rewrite: SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS western_dark_production FROM info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title') AND kt.kind = 'movie' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info > '6.0' AND t.production_year > 2010 AND (t.title LIKE '%murder%' OR t.title LIKE '%Murder%' OR t.title LIKE '%Mord%') AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;
time used(s):9.221, index: 16, origin_cost: 972761.75, rewrite_cost: 972761.75, origin: SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS north_european_dark_production FROM info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IS NOT NULL AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info < '8.5' AND t.production_year > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;, rewrite: SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS north_european_dark_production FROM info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IS NOT NULL AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info < '8.5' AND t.production_year > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;
time used(s):8.44, index: 17, origin_cost: 2018250.375, rewrite_cost: 2018250.375, origin: SELECT MIN(an.name) AS cool_actor_pseudonym, MIN(t.title) AS series_named_after_char FROM aka_name AS an, cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND t.episode_nr >= 50 AND t.episode_nr < 100 AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(an.name) AS cool_actor_pseudonym, MIN(t.title) AS series_named_after_char FROM aka_name AS an, cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND t.episode_nr >= 50 AND t.episode_nr < 100 AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;
time used(s):8.712, index: 18, origin_cost: 1.0213406E7, rewrite_cost: 1.0213406E7, origin: SELECT MIN(an.name) AS cool_actor_pseudonym, MIN(t.title) AS series_named_after_char FROM aka_name AS an, cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(an.name) AS cool_actor_pseudonym, MIN(t.title) AS series_named_after_char FROM aka_name AS an, cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;
time used(s):9.025, index: 19, origin_cost: 4066885.75, rewrite_cost: 4066885.75, origin: SELECT MIN(an.name) AS cool_actor_pseudonym, MIN(t.title) AS series_named_after_char FROM aka_name AS an, cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND t.episode_nr < 100 AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(an.name) AS cool_actor_pseudonym, MIN(t.title) AS series_named_after_char FROM aka_name AS an, cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND t.episode_nr < 100 AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;
time used(s):8.625, index: 20, origin_cost: 2018250.375, rewrite_cost: 2018250.375, origin: SELECT MIN(an.name) AS cool_actor_pseudonym, MIN(t.title) AS series_named_after_char FROM aka_name AS an, cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND t.episode_nr >= 5 AND t.episode_nr < 100 AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(an.name) AS cool_actor_pseudonym, MIN(t.title) AS series_named_after_char FROM aka_name AS an, cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND t.episode_nr >= 5 AND t.episode_nr < 100 AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;
time used(s):8.621, index: 21, origin_cost: 6800158.0, rewrite_cost: 6800158.0, origin: SELECT MIN(n.name) AS member_in_charnamed_american_movie, MIN(n.name) AS a1 FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND n.name LIKE 'B%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(n.name) AS member_in_charnamed_american_movie, MIN(n.name) AS a1 FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND n.name LIKE 'B%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;
time used(s):8.616, index: 22, origin_cost: 2.2644896E7, rewrite_cost: 2.2644896E7, origin: SELECT MIN(n.name) AS member_in_charnamed_movie, MIN(n.name) AS a1 FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword ='character-name-in-title' AND n.name LIKE 'Z%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(n.name) AS member_in_charnamed_movie, MIN(n.name) AS a1 FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword ='character-name-in-title' AND n.name LIKE 'Z%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;
time used(s):8.782, index: 23, origin_cost: 2.2644896E7, rewrite_cost: 2.2644896E7, origin: SELECT MIN(n.name) AS member_in_charnamed_movie, MIN(n.name) AS a1 FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword ='character-name-in-title' AND n.name LIKE 'X%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(n.name) AS member_in_charnamed_movie, MIN(n.name) AS a1 FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword ='character-name-in-title' AND n.name LIKE 'X%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;
time used(s):8.664, index: 24, origin_cost: 2.2644896E7, rewrite_cost: 2.2644896E7, origin: SELECT MIN(n.name) AS member_in_charnamed_movie FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword ='character-name-in-title' AND n.name LIKE '%Bert%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(n.name) AS member_in_charnamed_movie FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword ='character-name-in-title' AND n.name LIKE '%Bert%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;
time used(s):8.645, index: 25, origin_cost: 6800158.0, rewrite_cost: 6800158.0, origin: SELECT MIN(n.name) AS member_in_charnamed_movie FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(n.name) AS member_in_charnamed_movie FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;
time used(s):8.651, index: 26, origin_cost: 2.2644896E7, rewrite_cost: 2.2644896E7, origin: SELECT MIN(n.name) AS member_in_charnamed_movie FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword ='character-name-in-title' AND n.name LIKE '%B%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(n.name) AS member_in_charnamed_movie FROM cast_info AS ci, company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword ='character-name-in-title' AND n.name LIKE '%B%' AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.movie_id = mc.movie_id AND ci.movie_id = mk.movie_id AND mc.movie_id = mk.movie_id;
time used(s):7.62, index: 27, origin_cost: 2083003.375, rewrite_cost: 2046677.875, origin: SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(t.title) AS movie_title FROM cast_info AS ci, info_type AS it1, info_type AS it2, movie_info AS mi, movie_info_idx AS mi_idx, name AS n, title AS t WHERE ci.note IN ('(producer)', '(executive producer)') AND it1.info = 'budget' AND it2.info = 'votes' AND n.gender = 'm' AND n.name LIKE '%Tim%' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info2204`.`info`) AS `movie_budget`, MIN(`movie_info_idx2204`.`info`) AS `movie_votes`, MIN(`title5480`.`title`) AS `movie_title` FROM `cast_info` AS `cast_info2816`, `info_type` AS `info_type4409`, `info_type` AS `info_type4410`, `movie_info` AS `movie_info2204`, `movie_info_idx` AS `movie_info_idx2204`, `name` AS `name2204`, `title` AS `title5480` WHERE (`cast_info2816`.`note` = '(producer)' OR `cast_info2816`.`note` = '(executive producer)') AND (`info_type4409`.`info` = 'budget' AND `info_type4410`.`info` = 'votes') AND (`name2204`.`gender` = 'm' AND `name2204`.`name` LIKE '%Tim%' AND (`title5480`.`id` = `movie_info2204`.`movie_id` AND `title5480`.`id` = `movie_info_idx2204`.`movie_id`)) AND (`title5480`.`id` = `cast_info2816`.`movie_id` AND (`cast_info2816`.`movie_id` = `movie_info2204`.`movie_id` AND `cast_info2816`.`movie_id` = `movie_info_idx2204`.`movie_id`) AND (`movie_info2204`.`movie_id` = `movie_info_idx2204`.`movie_id` AND `name2204`.`id` = `cast_info2816`.`person_id` AND (`info_type4409`.`id` = `movie_info2204`.`info_type_id` AND `info_type4410`.`id` = `movie_info_idx2204`.`info_type_id`)))
time used(s):4.364, index: 28, origin_cost: 918113.3125, rewrite_cost: 917890.6875, origin: SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(t.title) AS movie_title FROM cast_info AS ci, info_type AS it1, info_type AS it2, movie_info AS mi, movie_info_idx AS mi_idx, name AS n, title AS t WHERE ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info = 'genres' AND it2.info = 'rating' AND mi.info IN ('Horror', 'Thriller') AND mi.note IS NULL AND mi_idx.info > '8.0' AND n.gender IS NOT NULL AND n.gender = 'f' AND t.production_year BETWEEN 2008 AND 2014 AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info2256`.`info`) AS `movie_budget`, MIN(`movie_info_idx2256`.`info`) AS `movie_votes`, MIN(`title5582`.`title`) AS `movie_title` FROM `cast_info` AS `cast_info2868`, `info_type` AS `info_type4513`, `info_type` AS `info_type4514`, `movie_info` AS `movie_info2256`, `movie_info_idx` AS `movie_info_idx2256`, `name` AS `name2256`, `title` AS `title5582` WHERE (`cast_info2868`.`note` = '(writer)' OR `cast_info2868`.`note` = '(head writer)' OR `cast_info2868`.`note` = '(written by)' OR `cast_info2868`.`note` = '(story)' OR `cast_info2868`.`note` = '(story editor)') AND `info_type4513`.`info` = 'genres' AND (`info_type4514`.`info` = 'rating' AND (`movie_info2256`.`info` = 'Horror' OR `movie_info2256`.`info` = 'Thriller')) AND (`movie_info2256`.`note` IS NULL AND `movie_info_idx2256`.`info` > '8.0' AND (`name2256`.`gender` IS NOT NULL AND (`name2256`.`gender` = 'f' AND `title5582`.`production_year` >= 2008))) AND (`title5582`.`production_year` <= 2014 AND `title5582`.`id` = `movie_info2256`.`movie_id` AND (`title5582`.`id` = `movie_info_idx2256`.`movie_id` AND (`title5582`.`id` = `cast_info2868`.`movie_id` AND `cast_info2868`.`movie_id` = `movie_info2256`.`movie_id`)) AND (`cast_info2868`.`movie_id` = `movie_info_idx2256`.`movie_id` AND `movie_info2256`.`movie_id` = `movie_info_idx2256`.`movie_id` AND (`name2256`.`id` = `cast_info2868`.`person_id` AND (`info_type4513`.`id` = `movie_info2256`.`info_type_id` AND `info_type4514`.`id` = `movie_info_idx2256`.`info_type_id`))))
time used(s):7.481, index: 29, origin_cost: 4324157.0, rewrite_cost: 4209095.0, origin: SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(t.title) AS movie_title FROM cast_info AS ci, info_type AS it1, info_type AS it2, movie_info AS mi, movie_info_idx AS mi_idx, name AS n, title AS t WHERE ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info = 'genres' AND it2.info = 'votes' AND mi.info IN ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War') AND n.gender = 'm' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND mi.movie_id = mi_idx.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info2408`.`info`) AS `movie_budget`, MIN(`movie_info_idx2408`.`info`) AS `movie_votes`, MIN(`title5735`.`title`) AS `movie_title` FROM `cast_info` AS `cast_info3020`, `info_type` AS `info_type4817`, `info_type` AS `info_type4818`, `movie_info` AS `movie_info2408`, `movie_info_idx` AS `movie_info_idx2408`, `name` AS `name2408`, `title` AS `title5735` WHERE (`cast_info3020`.`note` = '(writer)' OR `cast_info3020`.`note` = '(head writer)' OR `cast_info3020`.`note` = '(written by)' OR `cast_info3020`.`note` = '(story)' OR `cast_info3020`.`note` = '(story editor)') AND (`info_type4817`.`info` = 'genres' AND `info_type4818`.`info` = 'votes') AND ((`movie_info2408`.`info` = 'Horror' OR (`movie_info2408`.`info` = 'Action' OR `movie_info2408`.`info` = 'Sci-Fi') OR (`movie_info2408`.`info` = 'Thriller' OR (`movie_info2408`.`info` = 'Crime' OR `movie_info2408`.`info` = 'War'))) AND `name2408`.`gender` = 'm' AND (`title5735`.`id` = `movie_info2408`.`movie_id` AND `title5735`.`id` = `movie_info_idx2408`.`movie_id`)) AND (`title5735`.`id` = `cast_info3020`.`movie_id` AND (`cast_info3020`.`movie_id` = `movie_info2408`.`movie_id` AND `cast_info3020`.`movie_id` = `movie_info_idx2408`.`movie_id`) AND (`movie_info2408`.`movie_id` = `movie_info_idx2408`.`movie_id` AND `name2408`.`id` = `cast_info3020`.`person_id` AND (`info_type4817`.`id` = `movie_info2408`.`info_type_id` AND `info_type4818`.`id` = `movie_info_idx2408`.`info_type_id`)))
time used(s):8.017, index: 30, origin_cost: 10903.0, rewrite_cost: 10396.1201171875, origin: SELECT MIN(n.name) AS voicing_actress, MIN(t.title) AS voiced_movie FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, movie_companies AS mc, movie_info AS mi, name AS n, role_type AS rt, title AS t WHERE ci.note IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND it.info = 'release dates' AND mc.note IS NOT NULL AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%') AND mi.info IS NOT NULL AND (mi.info LIKE 'Japan:%200%' OR mi.info LIKE 'USA:%200%') AND n.gender ='f' AND n.name LIKE '%Ang%' AND rt.role ='actress' AND t.production_year BETWEEN 2005 AND 2009 AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mi.movie_id = ci.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`name2415`.`name`) AS `voicing_actress`, MIN(`title5742`.`title`) AS `voiced_movie` FROM `aka_name` AS `aka_name819`, `char_name` AS `char_name615`, `cast_info` AS `cast_info3027`, `company_name` AS `company_name4605`, `info_type` AS `info_type4827`, `movie_companies` AS `movie_companies4605`, `movie_info` AS `movie_info2415`, `name` AS `name2415`, `role_type` AS `role_type615`, `title` AS `title5742` WHERE (`cast_info3027`.`note` = '(voice)' OR `cast_info3027`.`note` = '(voice: Japanese version)' OR `cast_info3027`.`note` = '(voice) (uncredited)' OR `cast_info3027`.`note` = '(voice: English version)') AND (`company_name4605`.`country_code` = '[us]' AND `info_type4827`.`info` = 'release dates') AND (`movie_companies4605`.`note` IS NOT NULL AND ((`movie_companies4605`.`note` LIKE '%(USA)%' OR `movie_companies4605`.`note` LIKE '%(worldwide)%') AND `movie_info2415`.`info` IS NOT NULL)) AND ((`movie_info2415`.`info` LIKE 'Japan:%200%' OR `movie_info2415`.`info` LIKE 'USA:%200%') AND (`name2415`.`gender` = 'f' AND `name2415`.`name` LIKE '%Ang%') AND (`role_type615`.`role` = 'actress' AND (`title5742`.`production_year` >= 2005 AND `title5742`.`production_year` <= 2009))) AND (`title5742`.`id` = `movie_info2415`.`movie_id` AND (`title5742`.`id` = `movie_companies4605`.`movie_id` AND `title5742`.`id` = `cast_info3027`.`movie_id`) AND (`movie_companies4605`.`movie_id` = `cast_info3027`.`movie_id` AND (`movie_companies4605`.`movie_id` = `movie_info2415`.`movie_id` AND `movie_info2415`.`movie_id` = `cast_info3027`.`movie_id`)) AND (`company_name4605`.`id` = `movie_companies4605`.`company_id` AND (`info_type4827`.`id` = `movie_info2415`.`info_type_id` AND `name2415`.`id` = `cast_info3027`.`person_id`) AND (`role_type615`.`id` = `cast_info3027`.`role_id` AND `name2415`.`id` = `aka_name819`.`person_id` AND (`cast_info3027`.`person_id` = `aka_name819`.`person_id` AND `char_name615`.`id` = `cast_info3027`.`person_role_id`))))
time used(s):10.818, index: 31, origin_cost: 8095.39013671875, rewrite_cost: 8095.39013671875, origin: SELECT MIN(n.name) AS voicing_actress, MIN(t.title) AS kung_fu_panda FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, movie_companies AS mc, movie_info AS mi, name AS n, role_type AS rt, title AS t WHERE ci.note = '(voice)' AND cn.country_code ='[us]' AND it.info = 'release dates' AND mc.note LIKE '%(200%)%' AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%') AND mi.info IS NOT NULL AND (mi.info LIKE 'Japan:%2007%' OR mi.info LIKE 'USA:%2008%') AND n.gender ='f' AND n.name LIKE '%Angel%' AND rt.role ='actress' AND t.production_year BETWEEN 2007 AND 2008 AND t.title LIKE '%Kung%Fu%Panda%' AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mi.movie_id = ci.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id;, rewrite: SELECT MIN(n.name) AS voicing_actress, MIN(t.title) AS kung_fu_panda FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, movie_companies AS mc, movie_info AS mi, name AS n, role_type AS rt, title AS t WHERE ci.note = '(voice)' AND cn.country_code ='[us]' AND it.info = 'release dates' AND mc.note LIKE '%(200%)%' AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%') AND mi.info IS NOT NULL AND (mi.info LIKE 'Japan:%2007%' OR mi.info LIKE 'USA:%2008%') AND n.gender ='f' AND n.name LIKE '%Angel%' AND rt.role ='actress' AND t.production_year BETWEEN 2007 AND 2008 AND t.title LIKE '%Kung%Fu%Panda%' AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mi.movie_id = ci.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id;
time used(s):10.645, index: 32, origin_cost: 12467.9296875, rewrite_cost: 11741.6298828125, origin: SELECT MIN(n.name) AS voicing_actress, MIN(t.title) AS jap_engl_voiced_movie FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, movie_companies AS mc, movie_info AS mi, name AS n, role_type AS rt, title AS t WHERE ci.note IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND it.info = 'release dates' AND mi.info IS NOT NULL AND (mi.info LIKE 'Japan:%200%' OR mi.info LIKE 'USA:%200%') AND n.gender ='f' AND n.name LIKE '%An%' AND rt.role ='actress' AND t.production_year > 2000 AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mi.movie_id = ci.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`name2926`.`name`) AS `voicing_actress`, MIN(`title6253`.`title`) AS `jap_engl_voiced_movie` FROM `aka_name` AS `aka_name1330`, `char_name` AS `char_name1126`, `cast_info` AS `cast_info3538`, `company_name` AS `company_name5116`, `info_type` AS `info_type5338`, `movie_companies` AS `movie_companies5116`, `movie_info` AS `movie_info2926`, `name` AS `name2926`, `role_type` AS `role_type1126`, `title` AS `title6253` WHERE (`cast_info3538`.`note` = '(voice)' OR `cast_info3538`.`note` = '(voice: Japanese version)' OR `cast_info3538`.`note` = '(voice) (uncredited)' OR `cast_info3538`.`note` = '(voice: English version)') AND `company_name5116`.`country_code` = '[us]' AND (`info_type5338`.`info` = 'release dates' AND (`movie_info2926`.`info` IS NOT NULL AND (`movie_info2926`.`info` LIKE 'Japan:%200%' OR `movie_info2926`.`info` LIKE 'USA:%200%'))) AND (`name2926`.`gender` = 'f' AND (`name2926`.`name` LIKE '%An%' AND `role_type1126`.`role` = 'actress') AND (`title6253`.`production_year` > 2000 AND (`title6253`.`id` = `movie_info2926`.`movie_id` AND `title6253`.`id` = `movie_companies5116`.`movie_id`))) AND (`title6253`.`id` = `cast_info3538`.`movie_id` AND `movie_companies5116`.`movie_id` = `cast_info3538`.`movie_id` AND (`movie_companies5116`.`movie_id` = `movie_info2926`.`movie_id` AND (`movie_info2926`.`movie_id` = `cast_info3538`.`movie_id` AND `company_name5116`.`id` = `movie_companies5116`.`company_id`)) AND (`info_type5338`.`id` = `movie_info2926`.`info_type_id` AND (`name2926`.`id` = `cast_info3538`.`person_id` AND `role_type1126`.`id` = `cast_info3538`.`role_id`) AND (`name2926`.`id` = `aka_name1330`.`person_id` AND (`cast_info3538`.`person_id` = `aka_name1330`.`person_id` AND `char_name1126`.`id` = `cast_info3538`.`person_role_id`))))
time used(s):7.892, index: 33, origin_cost: 13114.240234375, rewrite_cost: 12297.2900390625, origin: SELECT MIN(n.name) AS voicing_actress, MIN(t.title) AS jap_engl_voiced_movie FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, movie_companies AS mc, movie_info AS mi, name AS n, role_type AS rt, title AS t WHERE ci.note IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND it.info = 'release dates' AND n.gender ='f' AND rt.role ='actress' AND t.production_year > 2000 AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mi.movie_id = ci.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`name3080`.`name`) AS `voicing_actress`, MIN(`title6407`.`title`) AS `jap_engl_voiced_movie` FROM `aka_name` AS `aka_name1484`, `char_name` AS `char_name1280`, `cast_info` AS `cast_info3692`, `company_name` AS `company_name5270`, `info_type` AS `info_type5492`, `movie_companies` AS `movie_companies5270`, `movie_info` AS `movie_info3080`, `name` AS `name3080`, `role_type` AS `role_type1280`, `title` AS `title6407` WHERE (`cast_info3692`.`note` = '(voice)' OR `cast_info3692`.`note` = '(voice: Japanese version)' OR `cast_info3692`.`note` = '(voice) (uncredited)' OR `cast_info3692`.`note` = '(voice: English version)') AND `company_name5270`.`country_code` = '[us]' AND (`info_type5492`.`info` = 'release dates' AND `name3080`.`gender` = 'f') AND (`role_type1280`.`role` = 'actress' AND `title6407`.`production_year` > 2000 AND (`title6407`.`id` = `movie_info3080`.`movie_id` AND (`title6407`.`id` = `movie_companies5270`.`movie_id` AND `title6407`.`id` = `cast_info3692`.`movie_id`))) AND (`movie_companies5270`.`movie_id` = `cast_info3692`.`movie_id` AND `movie_companies5270`.`movie_id` = `movie_info3080`.`movie_id` AND (`movie_info3080`.`movie_id` = `cast_info3692`.`movie_id` AND (`company_name5270`.`id` = `movie_companies5270`.`company_id` AND `info_type5492`.`id` = `movie_info3080`.`info_type_id`)) AND (`name3080`.`id` = `cast_info3692`.`person_id` AND `role_type1280`.`id` = `cast_info3692`.`role_id` AND (`name3080`.`id` = `aka_name1484`.`person_id` AND (`cast_info3692`.`person_id` = `aka_name1484`.`person_id` AND `char_name1280`.`id` = `cast_info3692`.`person_role_id`))))
time used(s):8.773, index: 34, origin_cost: 2413864.75, rewrite_cost: 2413864.75, origin: SELECT MIN(mc.note) AS production_note, MIN(t.title) AS movie_title, MIN(t.production_year) AS movie_year FROM company_type AS ct, info_type AS it, movie_companies AS mc, movie_info_idx AS mi_idx, title AS t WHERE ct.kind = 'production companies' AND it.info = 'top 250 rank' AND mc.note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' AND (mc.note LIKE '%(co-production)%' OR mc.note LIKE '%(presents)%') AND ct.id = mc.company_type_id AND t.id = mc.movie_id AND t.id = mi_idx.movie_id AND mc.movie_id = mi_idx.movie_id AND it.id = mi_idx.info_type_id;, rewrite: SELECT MIN(mc.note) AS production_note, MIN(t.title) AS movie_title, MIN(t.production_year) AS movie_year FROM company_type AS ct, info_type AS it, movie_companies AS mc, movie_info_idx AS mi_idx, title AS t WHERE ct.kind = 'production companies' AND it.info = 'top 250 rank' AND mc.note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' AND (mc.note LIKE '%(co-production)%' OR mc.note LIKE '%(presents)%') AND ct.id = mc.company_type_id AND t.id = mc.movie_id AND t.id = mi_idx.movie_id AND mc.movie_id = mi_idx.movie_id AND it.id = mi_idx.info_type_id;
time used(s):12.782, index: 35, origin_cost: 2142790.5, rewrite_cost: 2142786.0, origin: SELECT MIN(mc.note) AS production_note, MIN(t.title) AS movie_title, MIN(t.production_year) AS movie_year FROM company_type AS ct, info_type AS it, movie_companies AS mc, movie_info_idx AS mi_idx, title AS t WHERE ct.kind = 'production companies' AND it.info = 'bottom 10 rank' AND mc.note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' AND t.production_year BETWEEN 2005 AND 2010 AND ct.id = mc.company_type_id AND t.id = mc.movie_id AND t.id = mi_idx.movie_id AND mc.movie_id = mi_idx.movie_id AND it.id = mi_idx.info_type_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`t29029`.`note`) AS `production_note`, MIN(`t29030`.`title`) AS `movie_title`, MIN(`t29030`.`production_year`) AS `movie_year` FROM (SELECT * FROM `company_type` WHERE `kind` = 'production companies') AS `t29027` CROSS JOIN (SELECT * FROM `info_type` WHERE `info` = 'bottom 10 rank') AS `t29028` INNER JOIN (SELECT * FROM `movie_companies` WHERE `note` NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%') AS `t29029` ON `t29027`.`id` = `t29029`.`company_type_id` INNER JOIN `movie_info_idx` AS `movie_info_idx2817` ON `t29029`.`movie_id` = `movie_info_idx2817`.`movie_id` AND `t29028`.`id` = `movie_info_idx2817`.`info_type_id` INNER JOIN (SELECT * FROM `title` WHERE `production_year` >= 2005 AND `production_year` <= 2010) AS `t29030` ON `t29029`.`movie_id` = `t29030`.`id` AND `movie_info_idx2817`.`movie_id` = `t29030`.`id`
time used(s):9.332, index: 36, origin_cost: 1448959.75, rewrite_cost: 1448959.75, origin: SELECT MIN(mc.note) AS production_note, MIN(t.title) AS movie_title, MIN(t.production_year) AS movie_year FROM company_type AS ct, info_type AS it, movie_companies AS mc, movie_info_idx AS mi_idx, title AS t WHERE ct.kind = 'production companies' AND it.info = 'top 250 rank' AND mc.note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' AND (mc.note LIKE '%(co-production)%') AND t.production_year >2010 AND ct.id = mc.company_type_id AND t.id = mc.movie_id AND t.id = mi_idx.movie_id AND mc.movie_id = mi_idx.movie_id AND it.id = mi_idx.info_type_id;, rewrite: SELECT MIN(mc.note) AS production_note, MIN(t.title) AS movie_title, MIN(t.production_year) AS movie_year FROM company_type AS ct, info_type AS it, movie_companies AS mc, movie_info_idx AS mi_idx, title AS t WHERE ct.kind = 'production companies' AND it.info = 'top 250 rank' AND mc.note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' AND (mc.note LIKE '%(co-production)%') AND t.production_year >2010 AND ct.id = mc.company_type_id AND t.id = mc.movie_id AND t.id = mi_idx.movie_id AND mc.movie_id = mi_idx.movie_id AND it.id = mi_idx.info_type_id;
time used(s):9.705, index: 37, origin_cost: 2232956.5, rewrite_cost: 2232956.5, origin: SELECT MIN(mc.note) AS production_note, MIN(t.title) AS movie_title, MIN(t.production_year) AS movie_year FROM company_type AS ct, info_type AS it, movie_companies AS mc, movie_info_idx AS mi_idx, title AS t WHERE ct.kind = 'production companies' AND it.info = 'bottom 10 rank' AND mc.note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' AND t.production_year >2000 AND ct.id = mc.company_type_id AND t.id = mc.movie_id AND t.id = mi_idx.movie_id AND mc.movie_id = mi_idx.movie_id AND it.id = mi_idx.info_type_id;, rewrite: SELECT MIN(mc.note) AS production_note, MIN(t.title) AS movie_title, MIN(t.production_year) AS movie_year FROM company_type AS ct, info_type AS it, movie_companies AS mc, movie_info_idx AS mi_idx, title AS t WHERE ct.kind = 'production companies' AND it.info = 'bottom 10 rank' AND mc.note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%' AND t.production_year >2000 AND ct.id = mc.company_type_id AND t.id = mc.movie_id AND t.id = mi_idx.movie_id AND mc.movie_id = mi_idx.movie_id AND it.id = mi_idx.info_type_id;
time used(s):10.616, index: 38, origin_cost: 36807.9296875, rewrite_cost: 36807.9296875, origin: SELECT MIN(t.title) AS complete_downey_ironman_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, keyword AS k, kind_type AS kt, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE '%complete%' AND chn.name NOT LIKE '%Sherlock%' AND (chn.name LIKE '%Tony%Stark%' OR chn.name LIKE '%Iron%Man%') AND k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND kt.kind = 'movie' AND t.production_year > 1950 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND ci.movie_id = cc.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;, rewrite: SELECT MIN(t.title) AS complete_downey_ironman_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, keyword AS k, kind_type AS kt, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE '%complete%' AND chn.name NOT LIKE '%Sherlock%' AND (chn.name LIKE '%Tony%Stark%' OR chn.name LIKE '%Iron%Man%') AND k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND kt.kind = 'movie' AND t.production_year > 1950 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND ci.movie_id = cc.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;
time used(s):11.054, index: 39, origin_cost: 33290.828125, rewrite_cost: 33290.828125, origin: SELECT MIN(t.title) AS complete_downey_ironman_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, keyword AS k, kind_type AS kt, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE '%complete%' AND chn.name NOT LIKE '%Sherlock%' AND (chn.name LIKE '%Tony%Stark%' OR chn.name LIKE '%Iron%Man%') AND k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND kt.kind = 'movie' AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND ci.movie_id = cc.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;, rewrite: SELECT MIN(t.title) AS complete_downey_ironman_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, keyword AS k, kind_type AS kt, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE '%complete%' AND chn.name NOT LIKE '%Sherlock%' AND (chn.name LIKE '%Tony%Stark%' OR chn.name LIKE '%Iron%Man%') AND k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND kt.kind = 'movie' AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND ci.movie_id = cc.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;
time used(s):10.603, index: 40, origin_cost: 36861.37890625, rewrite_cost: 36861.37890625, origin: SELECT MIN(n.name) AS cast_member, MIN(t.title) AS complete_dynamic_hero_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, keyword AS k, kind_type AS kt, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE '%complete%' AND chn.name IS NOT NULL AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%') AND k.keyword IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser') AND kt.kind = 'movie' AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND ci.movie_id = cc.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;, rewrite: SELECT MIN(n.name) AS cast_member, MIN(t.title) AS complete_dynamic_hero_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, keyword AS k, kind_type AS kt, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE '%complete%' AND chn.name IS NOT NULL AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%') AND k.keyword IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser') AND kt.kind = 'movie' AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND ci.movie_id = cc.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;
time used(s):5.078, index: 41, origin_cost: 7858.27001953125, rewrite_cost: 7858.080078125, origin: SELECT MIN(cn.name) AS company_name, MIN(lt.link) AS link_type, MIN(t.title) AS western_follow_up FROM company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German') AND t.production_year BETWEEN 1950 AND 2000 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND mi.movie_id = t.id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND ml.movie_id = mi.movie_id AND mk.movie_id = mi.movie_id AND mc.movie_id = mi.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`company_name5324`.`name`) AS `company_name`, MIN(`link_type572`.`link`) AS `link_type`, MIN(`title7939`.`title`) AS `western_follow_up` FROM `company_name` AS `company_name5324`, `company_type` AS `company_type3428`, `keyword` AS `keyword3836`, `link_type` AS `link_type572`, `movie_companies` AS `movie_companies6140`, `movie_info` AS `movie_info3134`, `movie_keyword` AS `movie_keyword3836`, `movie_link` AS `movie_link572`, `title` AS `title7939` WHERE `company_name5324`.`country_code` <> '[pl]' AND (`company_name5324`.`name` LIKE '%Film%' OR `company_name5324`.`name` LIKE '%Warner%') AND (`company_type3428`.`kind` = 'production companies' AND (`keyword3836`.`keyword` = 'sequel' AND `link_type572`.`link` LIKE '%follow%')) AND (`movie_companies6140`.`note` IS NULL AND ((`movie_info3134`.`info` = 'Sweden' OR `movie_info3134`.`info` = 'Norway' OR (`movie_info3134`.`info` = 'Germany' OR `movie_info3134`.`info` = 'Denmark') OR (`movie_info3134`.`info` = 'Swedish' OR `movie_info3134`.`info` = 'Denish' OR (`movie_info3134`.`info` = 'Norwegian' OR `movie_info3134`.`info` = 'German'))) AND `title7939`.`production_year` >= 1950) AND (`title7939`.`production_year` <= 2000 AND (`link_type572`.`id` = `movie_link572`.`link_type_id` AND `movie_link572`.`movie_id` = `title7939`.`id`))) AND (`title7939`.`id` = `movie_keyword3836`.`movie_id` AND (`movie_keyword3836`.`keyword_id` = `keyword3836`.`id` AND `title7939`.`id` = `movie_companies6140`.`movie_id`) AND (`movie_companies6140`.`company_type_id` = `company_type3428`.`id` AND (`movie_companies6140`.`company_id` = `company_name5324`.`id` AND `movie_info3134`.`movie_id` = `title7939`.`id`)) AND (`movie_link572`.`movie_id` = `movie_keyword3836`.`movie_id` AND (`movie_link572`.`movie_id` = `movie_companies6140`.`movie_id` AND `movie_keyword3836`.`movie_id` = `movie_companies6140`.`movie_id`) AND (`movie_link572`.`movie_id` = `movie_info3134`.`movie_id` AND (`movie_keyword3836`.`movie_id` = `movie_info3134`.`movie_id` AND `movie_companies6140`.`movie_id` = `movie_info3134`.`movie_id`))))
time used(s):4.983, index: 42, origin_cost: 7855.43017578125, rewrite_cost: 7831.64013671875, origin: SELECT MIN(cn.name) AS company_name, MIN(lt.link) AS link_type, MIN(t.title) AS german_follow_up FROM company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND mi.info IN ('Germany', 'German') AND t.production_year BETWEEN 2000 AND 2010 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND mi.movie_id = t.id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND ml.movie_id = mi.movie_id AND mk.movie_id = mi.movie_id AND mc.movie_id = mi.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`company_name5376`.`name`) AS `company_name`, MIN(`link_type624`.`link`) AS `link_type`, MIN(`title8042`.`title`) AS `german_follow_up` FROM `company_name` AS `company_name5376`, `company_type` AS `company_type3480`, `keyword` AS `keyword3888`, `link_type` AS `link_type624`, `movie_companies` AS `movie_companies6192`, `movie_info` AS `movie_info3186`, `movie_keyword` AS `movie_keyword3888`, `movie_link` AS `movie_link624`, `title` AS `title8042` WHERE `company_name5376`.`country_code` <> '[pl]' AND (`company_name5376`.`name` LIKE '%Film%' OR `company_name5376`.`name` LIKE '%Warner%') AND (`company_type3480`.`kind` = 'production companies' AND (`keyword3888`.`keyword` = 'sequel' AND `link_type624`.`link` LIKE '%follow%')) AND (`movie_companies6192`.`note` IS NULL AND ((`movie_info3186`.`info` = 'Germany' OR `movie_info3186`.`info` = 'German') AND `title8042`.`production_year` >= 2000) AND (`title8042`.`production_year` <= 2010 AND (`link_type624`.`id` = `movie_link624`.`link_type_id` AND `movie_link624`.`movie_id` = `title8042`.`id`))) AND (`title8042`.`id` = `movie_keyword3888`.`movie_id` AND (`movie_keyword3888`.`keyword_id` = `keyword3888`.`id` AND `title8042`.`id` = `movie_companies6192`.`movie_id`) AND (`movie_companies6192`.`company_type_id` = `company_type3480`.`id` AND (`movie_companies6192`.`company_id` = `company_name5376`.`id` AND `movie_info3186`.`movie_id` = `title8042`.`id`)) AND (`movie_link624`.`movie_id` = `movie_keyword3888`.`movie_id` AND (`movie_link624`.`movie_id` = `movie_companies6192`.`movie_id` AND `movie_keyword3888`.`movie_id` = `movie_companies6192`.`movie_id`) AND (`movie_link624`.`movie_id` = `movie_info3186`.`movie_id` AND (`movie_keyword3888`.`movie_id` = `movie_info3186`.`movie_id` AND `movie_companies6192`.`movie_id` = `movie_info3186`.`movie_id`))))
time used(s):5.06, index: 43, origin_cost: 7858.27001953125, rewrite_cost: 7858.080078125, origin: SELECT MIN(cn.name) AS company_name, MIN(lt.link) AS link_type, MIN(t.title) AS western_follow_up FROM company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'English') AND t.production_year BETWEEN 1950 AND 2010 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND mi.movie_id = t.id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND ml.movie_id = mi.movie_id AND mk.movie_id = mi.movie_id AND mc.movie_id = mi.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`company_name5428`.`name`) AS `company_name`, MIN(`link_type676`.`link`) AS `link_type`, MIN(`title8145`.`title`) AS `western_follow_up` FROM `company_name` AS `company_name5428`, `company_type` AS `company_type3532`, `keyword` AS `keyword3940`, `link_type` AS `link_type676`, `movie_companies` AS `movie_companies6244`, `movie_info` AS `movie_info3238`, `movie_keyword` AS `movie_keyword3940`, `movie_link` AS `movie_link676`, `title` AS `title8145` WHERE `company_name5428`.`country_code` <> '[pl]' AND (`company_name5428`.`name` LIKE '%Film%' OR `company_name5428`.`name` LIKE '%Warner%') AND (`company_type3532`.`kind` = 'production companies' AND (`keyword3940`.`keyword` = 'sequel' AND `link_type676`.`link` LIKE '%follow%')) AND (`movie_companies6244`.`note` IS NULL AND ((`movie_info3238`.`info` = 'Sweden' OR `movie_info3238`.`info` = 'Norway' OR (`movie_info3238`.`info` = 'Germany' OR `movie_info3238`.`info` = 'Denmark') OR (`movie_info3238`.`info` = 'Swedish' OR `movie_info3238`.`info` = 'Denish' OR (`movie_info3238`.`info` = 'Norwegian' OR (`movie_info3238`.`info` = 'German' OR `movie_info3238`.`info` = 'English')))) AND `title8145`.`production_year` >= 1950) AND (`title8145`.`production_year` <= 2010 AND (`link_type676`.`id` = `movie_link676`.`link_type_id` AND `movie_link676`.`movie_id` = `title8145`.`id`))) AND (`title8145`.`id` = `movie_keyword3940`.`movie_id` AND (`movie_keyword3940`.`keyword_id` = `keyword3940`.`id` AND `title8145`.`id` = `movie_companies6244`.`movie_id`) AND (`movie_companies6244`.`company_type_id` = `company_type3532`.`id` AND (`movie_companies6244`.`company_id` = `company_name5428`.`id` AND `movie_info3238`.`movie_id` = `title8145`.`id`)) AND (`movie_link676`.`movie_id` = `movie_keyword3940`.`movie_id` AND (`movie_link676`.`movie_id` = `movie_companies6244`.`movie_id` AND `movie_keyword3940`.`movie_id` = `movie_companies6244`.`movie_id`) AND (`movie_link676`.`movie_id` = `movie_info3238`.`movie_id` AND (`movie_keyword3940`.`movie_id` = `movie_info3238`.`movie_id` AND `movie_companies6244`.`movie_id` = `movie_info3238`.`movie_id`))))
time used(s):12.482, index: 44, origin_cost: 941486.3125, rewrite_cost: 941486.3125, origin: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS western_violent_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mc.note NOT LIKE '%(USA)%' AND mc.note LIKE '%(200%)%' AND mi.info IN ('Germany', 'German', 'USA', 'American') AND mi_idx.info < '7.0' AND t.production_year > 2008 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mc.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id;, rewrite: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS western_violent_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mc.note NOT LIKE '%(USA)%' AND mc.note LIKE '%(200%)%' AND mi.info IN ('Germany', 'German', 'USA', 'American') AND mi_idx.info < '7.0' AND t.production_year > 2008 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mc.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id;
time used(s):12.495, index: 45, origin_cost: 941486.3125, rewrite_cost: 941486.3125, origin: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS western_violent_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mc.note NOT LIKE '%(USA)%' AND mc.note LIKE '%(200%)%' AND mi.info IN ('Germany', 'German', 'USA', 'American') AND mi_idx.info < '7.0' AND t.production_year > 2009 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mc.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id;, rewrite: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS western_violent_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mc.note NOT LIKE '%(USA)%' AND mc.note LIKE '%(200%)%' AND mi.info IN ('Germany', 'German', 'USA', 'American') AND mi_idx.info < '7.0' AND t.production_year > 2009 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mc.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id;
time used(s):12.514, index: 46, origin_cost: 942658.3125, rewrite_cost: 942658.3125, origin: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS western_violent_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mc.note NOT LIKE '%(USA)%' AND mc.note LIKE '%(200%)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info < '8.5' AND t.production_year > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mc.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id;, rewrite: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS western_violent_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mc.note NOT LIKE '%(USA)%' AND mc.note LIKE '%(200%)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info < '8.5' AND t.production_year > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mc.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id;
time used(s):12.107, index: 47, origin_cost: 993419.8125, rewrite_cost: 993419.8125, origin: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS western_violent_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info < '8.5' AND t.production_year > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mc.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id;, rewrite: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS western_violent_movie FROM company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info < '8.5' AND t.production_year > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mc.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id;
time used(s):11.929, index: 48, origin_cost: 48366.4296875, rewrite_cost: 48366.4296875, origin: SELECT MIN(kt.kind) AS movie_kind, MIN(t.title) AS complete_us_internet_movie FROM complete_cast AS cc, comp_cast_type AS cct1, company_name AS cn, company_type AS ct, info_type AS it1, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, title AS t WHERE cct1.kind = 'complete+verified' AND cn.country_code = '[us]' AND it1.info = 'release dates' AND kt.kind IN ('movie') AND mi.note LIKE '%internet%' AND mi.info IS NOT NULL AND (mi.info LIKE 'USA:% 199%' OR mi.info LIKE 'USA:% 200%') AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND cct1.id = cc.status_id;, rewrite: SELECT MIN(kt.kind) AS movie_kind, MIN(t.title) AS complete_us_internet_movie FROM complete_cast AS cc, comp_cast_type AS cct1, company_name AS cn, company_type AS ct, info_type AS it1, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, title AS t WHERE cct1.kind = 'complete+verified' AND cn.country_code = '[us]' AND it1.info = 'release dates' AND kt.kind IN ('movie') AND mi.note LIKE '%internet%' AND mi.info IS NOT NULL AND (mi.info LIKE 'USA:% 199%' OR mi.info LIKE 'USA:% 200%') AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND cct1.id = cc.status_id;
time used(s):12.654, index: 49, origin_cost: 48284.48828125, rewrite_cost: 48284.48828125, origin: SELECT MIN(kt.kind) AS movie_kind, MIN(t.title) AS complete_nerdy_internet_movie FROM complete_cast AS cc, comp_cast_type AS cct1, company_name AS cn, company_type AS ct, info_type AS it1, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, title AS t WHERE cct1.kind = 'complete+verified' AND cn.country_code = '[us]' AND it1.info = 'release dates' AND k.keyword IN ('nerd', 'loner', 'alienation', 'dignity') AND kt.kind IN ('movie') AND mi.note LIKE '%internet%' AND mi.info LIKE 'USA:% 200%' AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND cct1.id = cc.status_id;, rewrite: SELECT MIN(kt.kind) AS movie_kind, MIN(t.title) AS complete_nerdy_internet_movie FROM complete_cast AS cc, comp_cast_type AS cct1, company_name AS cn, company_type AS ct, info_type AS it1, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, title AS t WHERE cct1.kind = 'complete+verified' AND cn.country_code = '[us]' AND it1.info = 'release dates' AND k.keyword IN ('nerd', 'loner', 'alienation', 'dignity') AND kt.kind IN ('movie') AND mi.note LIKE '%internet%' AND mi.info LIKE 'USA:% 200%' AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND cct1.id = cc.status_id;
time used(s):9.683, index: 50, origin_cost: 71870.171875, rewrite_cost: 71867.609375, origin: SELECT MIN(kt.kind) AS movie_kind, MIN(t.title) AS complete_us_internet_movie FROM complete_cast AS cc, comp_cast_type AS cct1, company_name AS cn, company_type AS ct, info_type AS it1, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, title AS t WHERE cct1.kind = 'complete+verified' AND cn.country_code = '[us]' AND it1.info = 'release dates' AND kt.kind IN ('movie', 'tv movie', 'video movie', 'video game') AND mi.note LIKE '%internet%' AND mi.info IS NOT NULL AND (mi.info LIKE 'USA:% 199%' OR mi.info LIKE 'USA:% 200%') AND t.production_year > 1990 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND cn.id = mc.company_id AND ct.id = mc.company_type_id AND cct1.id = cc.status_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`kind_type3414`.`kind`) AS `movie_kind`, MIN(`title9522`.`title`) AS `complete_us_internet_movie` FROM `complete_cast` AS `complete_cast1170`, `comp_cast_type` AS `comp_cast_type1782`, `company_name` AS `company_name6804`, `company_type` AS `company_type4908`, `info_type` AS `info_type8502`, `keyword` AS `keyword5316`, `kind_type` AS `kind_type3414`, `movie_companies` AS `movie_companies7620`, `movie_info` AS `movie_info4614`, `movie_keyword` AS `movie_keyword5316`, `title` AS `title9522` WHERE `comp_cast_type1782`.`kind` = 'complete+verified' AND (`company_name6804`.`country_code` = '[us]' AND `info_type8502`.`info` = 'release dates') AND ((`kind_type3414`.`kind` = 'movie' OR `kind_type3414`.`kind` = 'tv movie' OR `kind_type3414`.`kind` = 'video movie' OR `kind_type3414`.`kind` = 'video game') AND (`movie_info4614`.`note` LIKE '%internet%' AND `movie_info4614`.`info` IS NOT NULL)) AND ((`movie_info4614`.`info` LIKE 'USA:% 199%' OR `movie_info4614`.`info` LIKE 'USA:% 200%') AND (`title9522`.`production_year` > 1990 AND `kind_type3414`.`id` = `title9522`.`kind_id`) AND (`title9522`.`id` = `movie_info4614`.`movie_id` AND (`title9522`.`id` = `movie_keyword5316`.`movie_id` AND `title9522`.`id` = `movie_companies7620`.`movie_id`))) AND (`title9522`.`id` = `complete_cast1170`.`movie_id` AND (`movie_keyword5316`.`movie_id` = `movie_info4614`.`movie_id` AND `movie_keyword5316`.`movie_id` = `movie_companies7620`.`movie_id`) AND (`movie_keyword5316`.`movie_id` = `complete_cast1170`.`movie_id` AND (`movie_info4614`.`movie_id` = `movie_companies7620`.`movie_id` AND `movie_info4614`.`movie_id` = `complete_cast1170`.`movie_id`)) AND (`movie_companies7620`.`movie_id` = `complete_cast1170`.`movie_id` AND (`keyword5316`.`id` = `movie_keyword5316`.`keyword_id` AND `info_type8502`.`id` = `movie_info4614`.`info_type_id`) AND (`company_name6804`.`id` = `movie_companies7620`.`company_id` AND (`company_type4908`.`id` = `movie_companies7620`.`company_type_id` AND `comp_cast_type1782`.`id` = `complete_cast1170`.`status_id`))))
time used(s):10.179, index: 51, origin_cost: 12491.5498046875, rewrite_cost: 11761.9296875, origin: SELECT MIN(chn.name) AS voiced_char_name, MIN(n.name) AS voicing_actress_name, MIN(t.title) AS voiced_action_movie_jap_eng FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, name AS n, role_type AS rt, title AS t WHERE ci.note IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND it.info = 'release dates' AND k.keyword IN ('hero', 'martial-arts', 'hand-to-hand-combat') AND mi.info IS NOT NULL AND (mi.info LIKE 'Japan:%201%' OR mi.info LIKE 'USA:%201%') AND n.gender ='f' AND n.name LIKE '%An%' AND rt.role ='actress' AND t.production_year > 2010 AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mc.movie_id = mk.movie_id AND mi.movie_id = ci.movie_id AND mi.movie_id = mk.movie_id AND ci.movie_id = mk.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id AND k.id = mk.keyword_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`char_name2046`.`name`) AS `voiced_char_name`, MIN(`name3846`.`name`) AS `voicing_actress_name`, MIN(`title9676`.`title`) AS `voiced_action_movie_jap_eng` FROM `aka_name` AS `aka_name1638`, `char_name` AS `char_name2046`, `cast_info` AS `cast_info4458`, `company_name` AS `company_name6958`, `info_type` AS `info_type8656`, `keyword` AS `keyword5470`, `movie_companies` AS `movie_companies7774`, `movie_info` AS `movie_info4768`, `movie_keyword` AS `movie_keyword5470`, `name` AS `name3846`, `role_type` AS `role_type1434`, `title` AS `title9676` WHERE (`cast_info4458`.`note` = '(voice)' OR `cast_info4458`.`note` = '(voice: Japanese version)' OR `cast_info4458`.`note` = '(voice) (uncredited)' OR `cast_info4458`.`note` = '(voice: English version)') AND (`company_name6958`.`country_code` = '[us]' AND `info_type8656`.`info` = 'release dates') AND ((`keyword5470`.`keyword` = 'hero' OR `keyword5470`.`keyword` = 'martial-arts' OR `keyword5470`.`keyword` = 'hand-to-hand-combat') AND `movie_info4768`.`info` IS NOT NULL AND ((`movie_info4768`.`info` LIKE 'Japan:%201%' OR `movie_info4768`.`info` LIKE 'USA:%201%') AND `name3846`.`gender` = 'f')) AND (`name3846`.`name` LIKE '%An%' AND (`role_type1434`.`role` = 'actress' AND `title9676`.`production_year` > 2010) AND (`title9676`.`id` = `movie_info4768`.`movie_id` AND `title9676`.`id` = `movie_companies7774`.`movie_id` AND (`title9676`.`id` = `cast_info4458`.`movie_id` AND `title9676`.`id` = `movie_keyword5470`.`movie_id`))) AND (`movie_companies7774`.`movie_id` = `cast_info4458`.`movie_id` AND (`movie_companies7774`.`movie_id` = `movie_info4768`.`movie_id` AND `movie_companies7774`.`movie_id` = `movie_keyword5470`.`movie_id`) AND (`movie_info4768`.`movie_id` = `cast_info4458`.`movie_id` AND `movie_info4768`.`movie_id` = `movie_keyword5470`.`movie_id` AND (`cast_info4458`.`movie_id` = `movie_keyword5470`.`movie_id` AND `company_name6958`.`id` = `movie_companies7774`.`company_id`)) AND (`info_type8656`.`id` = `movie_info4768`.`info_type_id` AND (`name3846`.`id` = `cast_info4458`.`person_id` AND `role_type1434`.`id` = `cast_info4458`.`role_id`) AND (`name3846`.`id` = `aka_name1638`.`person_id` AND `cast_info4458`.`person_id` = `aka_name1638`.`person_id` AND (`char_name2046`.`id` = `cast_info4458`.`person_role_id` AND `keyword5470`.`id` = `movie_keyword5470`.`keyword_id`))))
time used(s):9.902, index: 52, origin_cost: 10545.1103515625, rewrite_cost: 10088.48046875, origin: SELECT MIN(chn.name) AS voiced_char_name, MIN(n.name) AS voicing_actress_name, MIN(t.title) AS kung_fu_panda FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, name AS n, role_type AS rt, title AS t WHERE ci.note IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND cn.name = 'DreamWorks Animation' AND it.info = 'release dates' AND k.keyword IN ('hero', 'martial-arts', 'hand-to-hand-combat', 'computer-animated-movie') AND mi.info IS NOT NULL AND (mi.info LIKE 'Japan:%201%' OR mi.info LIKE 'USA:%201%') AND n.gender ='f' AND n.name LIKE '%An%' AND rt.role ='actress' AND t.production_year > 2010 AND t.title LIKE 'Kung Fu Panda%' AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mc.movie_id = mk.movie_id AND mi.movie_id = ci.movie_id AND mi.movie_id = mk.movie_id AND ci.movie_id = mk.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id AND k.id = mk.keyword_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`char_name2200`.`name`) AS `voiced_char_name`, MIN(`name4000`.`name`) AS `voicing_actress_name`, MIN(`title9830`.`title`) AS `kung_fu_panda` FROM `aka_name` AS `aka_name1792`, `char_name` AS `char_name2200`, `cast_info` AS `cast_info4612`, `company_name` AS `company_name7112`, `info_type` AS `info_type8810`, `keyword` AS `keyword5624`, `movie_companies` AS `movie_companies7928`, `movie_info` AS `movie_info4922`, `movie_keyword` AS `movie_keyword5624`, `name` AS `name4000`, `role_type` AS `role_type1588`, `title` AS `title9830` WHERE (`cast_info4612`.`note` = '(voice)' OR `cast_info4612`.`note` = '(voice: Japanese version)' OR `cast_info4612`.`note` = '(voice) (uncredited)' OR `cast_info4612`.`note` = '(voice: English version)') AND (`company_name7112`.`country_code` = '[us]' AND `company_name7112`.`name` = 'DreamWorks Animation') AND (`info_type8810`.`info` = 'release dates' AND (`keyword5624`.`keyword` = 'hero' OR `keyword5624`.`keyword` = 'martial-arts' OR `keyword5624`.`keyword` = 'hand-to-hand-combat' OR `keyword5624`.`keyword` = 'computer-animated-movie') AND (`movie_info4922`.`info` IS NOT NULL AND (`movie_info4922`.`info` LIKE 'Japan:%201%' OR `movie_info4922`.`info` LIKE 'USA:%201%'))) AND (`name4000`.`gender` = 'f' AND `name4000`.`name` LIKE '%An%' AND (`role_type1588`.`role` = 'actress' AND `title9830`.`production_year` > 2010) AND (`title9830`.`title` LIKE 'Kung Fu Panda%' AND `title9830`.`id` = `movie_info4922`.`movie_id` AND (`title9830`.`id` = `movie_companies7928`.`movie_id` AND `title9830`.`id` = `cast_info4612`.`movie_id`))) AND (`title9830`.`id` = `movie_keyword5624`.`movie_id` AND (`movie_companies7928`.`movie_id` = `cast_info4612`.`movie_id` AND `movie_companies7928`.`movie_id` = `movie_info4922`.`movie_id`) AND (`movie_companies7928`.`movie_id` = `movie_keyword5624`.`movie_id` AND `movie_info4922`.`movie_id` = `cast_info4612`.`movie_id` AND (`movie_info4922`.`movie_id` = `movie_keyword5624`.`movie_id` AND `cast_info4612`.`movie_id` = `movie_keyword5624`.`movie_id`)) AND (`company_name7112`.`id` = `movie_companies7928`.`company_id` AND `info_type8810`.`id` = `movie_info4922`.`info_type_id` AND (`name4000`.`id` = `cast_info4612`.`person_id` AND `role_type1588`.`id` = `cast_info4612`.`role_id`) AND (`name4000`.`id` = `aka_name1792`.`person_id` AND `cast_info4612`.`person_id` = `aka_name1792`.`person_id` AND (`char_name2200`.`id` = `cast_info4612`.`person_role_id` AND `keyword5624`.`id` = `movie_keyword5624`.`keyword_id`))))
time used(s):10.54, index: 53, origin_cost: 3184634.25, rewrite_cost: 3153400.0, origin: SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS male_writer, MIN(t.title) AS violent_movie_title FROM cast_info AS ci, info_type AS it1, info_type AS it2, keyword AS k, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info = 'genres' AND it2.info = 'votes' AND k.keyword IN ('murder', 'blood', 'gore', 'death', 'female-nudity') AND mi.info = 'Horror' AND n.gender = 'm' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi_idx.movie_id = mk.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info5079`.`info`) AS `movie_budget`, MIN(`movie_info_idx4197`.`info`) AS `movie_votes`, MIN(`name4157`.`name`) AS `male_writer`, MIN(`title9987`.`title`) AS `violent_movie_title` FROM `cast_info` AS `cast_info4769`, `info_type` AS `info_type9121`, `info_type` AS `info_type9122`, `keyword` AS `keyword5781`, `movie_info` AS `movie_info5079`, `movie_info_idx` AS `movie_info_idx4197`, `movie_keyword` AS `movie_keyword5781`, `name` AS `name4157`, `title` AS `title9987` WHERE (`cast_info4769`.`note` = '(writer)' OR `cast_info4769`.`note` = '(head writer)' OR `cast_info4769`.`note` = '(written by)' OR `cast_info4769`.`note` = '(story)' OR `cast_info4769`.`note` = '(story editor)') AND `info_type9121`.`info` = 'genres' AND (`info_type9122`.`info` = 'votes' AND ((`keyword5781`.`keyword` = 'murder' OR `keyword5781`.`keyword` = 'blood' OR `keyword5781`.`keyword` = 'gore' OR `keyword5781`.`keyword` = 'death' OR `keyword5781`.`keyword` = 'female-nudity') AND `movie_info5079`.`info` = 'Horror')) AND (`name4157`.`gender` = 'm' AND `title9987`.`id` = `movie_info5079`.`movie_id` AND (`title9987`.`id` = `movie_info_idx4197`.`movie_id` AND (`title9987`.`id` = `cast_info4769`.`movie_id` AND `title9987`.`id` = `movie_keyword5781`.`movie_id`))) AND (`cast_info4769`.`movie_id` = `movie_info5079`.`movie_id` AND `cast_info4769`.`movie_id` = `movie_info_idx4197`.`movie_id` AND (`cast_info4769`.`movie_id` = `movie_keyword5781`.`movie_id` AND (`movie_info5079`.`movie_id` = `movie_info_idx4197`.`movie_id` AND `movie_info5079`.`movie_id` = `movie_keyword5781`.`movie_id`)) AND (`movie_info_idx4197`.`movie_id` = `movie_keyword5781`.`movie_id` AND `name4157`.`id` = `cast_info4769`.`person_id` AND (`info_type9121`.`id` = `movie_info5079`.`info_type_id` AND (`info_type9122`.`id` = `movie_info_idx4197`.`info_type_id` AND `keyword5781`.`id` = `movie_keyword5781`.`keyword_id`))))
time used(s):10.18, index: 54, origin_cost: 1227648.0, rewrite_cost: 1222964.5, origin: SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS male_writer, MIN(t.title) AS violent_movie_title FROM cast_info AS ci, info_type AS it1, info_type AS it2, keyword AS k, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info = 'genres' AND it2.info = 'votes' AND k.keyword IN ('murder', 'blood', 'gore', 'death', 'female-nudity') AND mi.info = 'Horror' AND n.gender = 'm' AND t.production_year > 2010 AND t.title LIKE 'Vampire%' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi_idx.movie_id = mk.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info5090`.`info`) AS `movie_budget`, MIN(`movie_info_idx4208`.`info`) AS `movie_votes`, MIN(`name4168`.`name`) AS `male_writer`, MIN(`title9998`.`title`) AS `violent_movie_title` FROM `cast_info` AS `cast_info4780`, `info_type` AS `info_type9143`, `info_type` AS `info_type9144`, `keyword` AS `keyword5792`, `movie_info` AS `movie_info5090`, `movie_info_idx` AS `movie_info_idx4208`, `movie_keyword` AS `movie_keyword5792`, `name` AS `name4168`, `title` AS `title9998` WHERE (`cast_info4780`.`note` = '(writer)' OR `cast_info4780`.`note` = '(head writer)' OR `cast_info4780`.`note` = '(written by)' OR `cast_info4780`.`note` = '(story)' OR `cast_info4780`.`note` = '(story editor)') AND `info_type9143`.`info` = 'genres' AND (`info_type9144`.`info` = 'votes' AND ((`keyword5792`.`keyword` = 'murder' OR `keyword5792`.`keyword` = 'blood' OR `keyword5792`.`keyword` = 'gore' OR `keyword5792`.`keyword` = 'death' OR `keyword5792`.`keyword` = 'female-nudity') AND `movie_info5090`.`info` = 'Horror')) AND (`name4168`.`gender` = 'm' AND (`title9998`.`production_year` > 2010 AND `title9998`.`title` LIKE 'Vampire%') AND (`title9998`.`id` = `movie_info5090`.`movie_id` AND (`title9998`.`id` = `movie_info_idx4208`.`movie_id` AND `title9998`.`id` = `cast_info4780`.`movie_id`))) AND (`title9998`.`id` = `movie_keyword5792`.`movie_id` AND `cast_info4780`.`movie_id` = `movie_info5090`.`movie_id` AND (`cast_info4780`.`movie_id` = `movie_info_idx4208`.`movie_id` AND (`cast_info4780`.`movie_id` = `movie_keyword5792`.`movie_id` AND `movie_info5090`.`movie_id` = `movie_info_idx4208`.`movie_id`)) AND (`movie_info5090`.`movie_id` = `movie_keyword5792`.`movie_id` AND (`movie_info_idx4208`.`movie_id` = `movie_keyword5792`.`movie_id` AND `name4168`.`id` = `cast_info4780`.`person_id`) AND (`info_type9143`.`id` = `movie_info5090`.`info_type_id` AND (`info_type9144`.`id` = `movie_info_idx4208`.`info_type_id` AND `keyword5792`.`id` = `movie_keyword5792`.`keyword_id`))))
time used(s):9.167, index: 55, origin_cost: 4804794.0, rewrite_cost: 4581226.5, origin: SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS male_writer, MIN(t.title) AS violent_movie_title FROM cast_info AS ci, info_type AS it1, info_type AS it2, keyword AS k, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info = 'genres' AND it2.info = 'votes' AND k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mi.info IN ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War') AND n.gender = 'm' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi_idx.movie_id = mk.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info5396`.`info`) AS `movie_budget`, MIN(`movie_info_idx4514`.`info`) AS `movie_votes`, MIN(`name4474`.`name`) AS `male_writer`, MIN(`title10304`.`title`) AS `violent_movie_title` FROM `cast_info` AS `cast_info5086`, `info_type` AS `info_type9755`, `info_type` AS `info_type9756`, `keyword` AS `keyword6098`, `movie_info` AS `movie_info5396`, `movie_info_idx` AS `movie_info_idx4514`, `movie_keyword` AS `movie_keyword6098`, `name` AS `name4474`, `title` AS `title10304` WHERE (`cast_info5086`.`note` = '(writer)' OR `cast_info5086`.`note` = '(head writer)' OR `cast_info5086`.`note` = '(written by)' OR `cast_info5086`.`note` = '(story)' OR `cast_info5086`.`note` = '(story editor)') AND `info_type9755`.`info` = 'genres' AND (`info_type9756`.`info` = 'votes' AND ((`keyword6098`.`keyword` = 'murder' OR (`keyword6098`.`keyword` = 'violence' OR `keyword6098`.`keyword` = 'blood') OR (`keyword6098`.`keyword` = 'gore' OR `keyword6098`.`keyword` = 'death' OR (`keyword6098`.`keyword` = 'female-nudity' OR `keyword6098`.`keyword` = 'hospital'))) AND (`movie_info5396`.`info` = 'Horror' OR (`movie_info5396`.`info` = 'Action' OR `movie_info5396`.`info` = 'Sci-Fi') OR (`movie_info5396`.`info` = 'Thriller' OR (`movie_info5396`.`info` = 'Crime' OR `movie_info5396`.`info` = 'War'))))) AND (`name4474`.`gender` = 'm' AND `title10304`.`id` = `movie_info5396`.`movie_id` AND (`title10304`.`id` = `movie_info_idx4514`.`movie_id` AND (`title10304`.`id` = `cast_info5086`.`movie_id` AND `title10304`.`id` = `movie_keyword6098`.`movie_id`))) AND (`cast_info5086`.`movie_id` = `movie_info5396`.`movie_id` AND `cast_info5086`.`movie_id` = `movie_info_idx4514`.`movie_id` AND (`cast_info5086`.`movie_id` = `movie_keyword6098`.`movie_id` AND (`movie_info5396`.`movie_id` = `movie_info_idx4514`.`movie_id` AND `movie_info5396`.`movie_id` = `movie_keyword6098`.`movie_id`)) AND (`movie_info_idx4514`.`movie_id` = `movie_keyword6098`.`movie_id` AND `name4474`.`id` = `cast_info5086`.`person_id` AND (`info_type9755`.`id` = `movie_info5396`.`info_type_id` AND (`info_type9756`.`id` = `movie_info_idx4514`.`info_type_id` AND `keyword6098`.`id` = `movie_keyword6098`.`keyword_id`))))
time used(s):16.455, index: 56, origin_cost: 30195.7890625, rewrite_cost: 30195.7890625, origin: SELECT MIN(chn.name) AS character_name, MIN(mi_idx.info) AS rating, MIN(n.name) AS playing_actor, MIN(t.title) AS complete_hero_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, info_type AS it2, keyword AS k, kind_type AS kt, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE '%complete%' AND chn.name IS NOT NULL AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%') AND it2.info = 'rating' AND k.keyword IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser') AND kt.kind = 'movie' AND mi_idx.info > '7.0' AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND mk.movie_id = mi_idx.movie_id AND ci.movie_id = cc.movie_id AND ci.movie_id = mi_idx.movie_id AND cc.movie_id = mi_idx.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND it2.id = mi_idx.info_type_id;, rewrite: SELECT MIN(chn.name) AS character_name, MIN(mi_idx.info) AS rating, MIN(n.name) AS playing_actor, MIN(t.title) AS complete_hero_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, info_type AS it2, keyword AS k, kind_type AS kt, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE '%complete%' AND chn.name IS NOT NULL AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%') AND it2.info = 'rating' AND k.keyword IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser') AND kt.kind = 'movie' AND mi_idx.info > '7.0' AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND mk.movie_id = mi_idx.movie_id AND ci.movie_id = cc.movie_id AND ci.movie_id = mi_idx.movie_id AND cc.movie_id = mi_idx.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND it2.id = mi_idx.info_type_id;
time used(s):13.958, index: 57, origin_cost: 30195.7890625, rewrite_cost: 30195.7890625, origin: SELECT MIN(chn.name) AS character_name, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_hero_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, info_type AS it2, keyword AS k, kind_type AS kt, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE '%complete%' AND chn.name IS NOT NULL AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%') AND it2.info = 'rating' AND k.keyword IN ('superhero', 'marvel-comics', 'based-on-comic', 'fight') AND kt.kind = 'movie' AND mi_idx.info > '8.0' AND t.production_year > 2005 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND mk.movie_id = mi_idx.movie_id AND ci.movie_id = cc.movie_id AND ci.movie_id = mi_idx.movie_id AND cc.movie_id = mi_idx.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND it2.id = mi_idx.info_type_id;, rewrite: SELECT MIN(chn.name) AS character_name, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_hero_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, info_type AS it2, keyword AS k, kind_type AS kt, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE '%complete%' AND chn.name IS NOT NULL AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%') AND it2.info = 'rating' AND k.keyword IN ('superhero', 'marvel-comics', 'based-on-comic', 'fight') AND kt.kind = 'movie' AND mi_idx.info > '8.0' AND t.production_year > 2005 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND mk.movie_id = mi_idx.movie_id AND ci.movie_id = cc.movie_id AND ci.movie_id = mi_idx.movie_id AND cc.movie_id = mi_idx.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND it2.id = mi_idx.info_type_id;
time used(s):17.15, index: 58, origin_cost: 31563.970703125, rewrite_cost: 31563.970703125, origin: SELECT MIN(chn.name) AS character_name, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_hero_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, info_type AS it2, keyword AS k, kind_type AS kt, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE '%complete%' AND chn.name IS NOT NULL AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%') AND it2.info = 'rating' AND k.keyword IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser') AND kt.kind = 'movie' AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND mk.movie_id = mi_idx.movie_id AND ci.movie_id = cc.movie_id AND ci.movie_id = mi_idx.movie_id AND cc.movie_id = mi_idx.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND it2.id = mi_idx.info_type_id;, rewrite: SELECT MIN(chn.name) AS character_name, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_hero_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, info_type AS it2, keyword AS k, kind_type AS kt, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE '%complete%' AND chn.name IS NOT NULL AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%') AND it2.info = 'rating' AND k.keyword IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser') AND kt.kind = 'movie' AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND t.id = mi_idx.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND mk.movie_id = mi_idx.movie_id AND ci.movie_id = cc.movie_id AND ci.movie_id = mi_idx.movie_id AND cc.movie_id = mi_idx.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND it2.id = mi_idx.info_type_id;
time used(s):5.645, index: 59, origin_cost: 6945.35009765625, rewrite_cost: 6945.14990234375, origin: SELECT MIN(cn.name) AS producing_company, MIN(lt.link) AS link_type, MIN(t.title) AS complete_western_sequel FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cct1.kind IN ('cast', 'crew') AND cct2.kind = 'complete' AND cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND mi.info IN ('Sweden', 'Germany', 'Swedish', 'German') AND t.production_year BETWEEN 1950 AND 2000 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND mi.movie_id = t.id AND t.id = cc.movie_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND ml.movie_id = mi.movie_id AND mk.movie_id = mi.movie_id AND mc.movie_id = mi.movie_id AND ml.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND mc.movie_id = cc.movie_id AND mi.movie_id = cc.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`company_name7166`.`name`) AS `producing_company`, MIN(`link_type728`.`link`) AS `link_type`, MIN(`title11020`.`title`) AS `complete_western_sequel` FROM `complete_cast` AS `complete_cast1836`, `comp_cast_type` AS `comp_cast_type3111`, `comp_cast_type` AS `comp_cast_type3112`, `company_name` AS `company_name7166`, `company_type` AS `company_type4962`, `keyword` AS `keyword6764`, `link_type` AS `link_type728`, `movie_companies` AS `movie_companies7982`, `movie_info` AS `movie_info5450`, `movie_keyword` AS `movie_keyword6764`, `movie_link` AS `movie_link728`, `title` AS `title11020` WHERE (`comp_cast_type3111`.`kind` = 'cast' OR `comp_cast_type3111`.`kind` = 'crew') AND `comp_cast_type3112`.`kind` = 'complete' AND (`company_name7166`.`country_code` <> '[pl]' AND (`company_name7166`.`name` LIKE '%Film%' OR `company_name7166`.`name` LIKE '%Warner%')) AND (`company_type4962`.`kind` = 'production companies' AND `keyword6764`.`keyword` = 'sequel' AND (`link_type728`.`link` LIKE '%follow%' AND `movie_companies7982`.`note` IS NULL)) AND ((`movie_info5450`.`info` = 'Sweden' OR `movie_info5450`.`info` = 'Germany' OR `movie_info5450`.`info` = 'Swedish' OR `movie_info5450`.`info` = 'German') AND `title11020`.`production_year` >= 1950 AND (`title11020`.`production_year` <= 2000 AND `link_type728`.`id` = `movie_link728`.`link_type_id`) AND (`movie_link728`.`movie_id` = `title11020`.`id` AND `title11020`.`id` = `movie_keyword6764`.`movie_id` AND (`movie_keyword6764`.`keyword_id` = `keyword6764`.`id` AND `title11020`.`id` = `movie_companies7982`.`movie_id`))) AND (`movie_companies7982`.`company_type_id` = `company_type4962`.`id` AND `movie_companies7982`.`company_id` = `company_name7166`.`id` AND (`movie_info5450`.`movie_id` = `title11020`.`id` AND `title11020`.`id` = `complete_cast1836`.`movie_id`) AND (`comp_cast_type3111`.`id` = `complete_cast1836`.`subject_id` AND `comp_cast_type3112`.`id` = `complete_cast1836`.`status_id` AND (`movie_link728`.`movie_id` = `movie_keyword6764`.`movie_id` AND `movie_link728`.`movie_id` = `movie_companies7982`.`movie_id`)) AND (`movie_keyword6764`.`movie_id` = `movie_companies7982`.`movie_id` AND `movie_link728`.`movie_id` = `movie_info5450`.`movie_id` AND (`movie_keyword6764`.`movie_id` = `movie_info5450`.`movie_id` AND `movie_companies7982`.`movie_id` = `movie_info5450`.`movie_id`) AND (`movie_link728`.`movie_id` = `complete_cast1836`.`movie_id` AND `movie_keyword6764`.`movie_id` = `complete_cast1836`.`movie_id` AND (`movie_companies7982`.`movie_id` = `complete_cast1836`.`movie_id` AND `movie_info5450`.`movie_id` = `complete_cast1836`.`movie_id`))))
time used(s):6.462, index: 60, origin_cost: 6841.31005859375, rewrite_cost: 6841.22998046875, origin: SELECT MIN(cn.name) AS producing_company, MIN(lt.link) AS link_type, MIN(t.title) AS complete_western_sequel FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cct1.kind IN ('cast', 'crew') AND cct2.kind = 'complete' AND cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND mi.info IN ('Sweden', 'Germany', 'Swedish', 'German') AND t.production_year = 1998 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND mi.movie_id = t.id AND t.id = cc.movie_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND ml.movie_id = mi.movie_id AND mk.movie_id = mi.movie_id AND mc.movie_id = mi.movie_id AND ml.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND mc.movie_id = cc.movie_id AND mi.movie_id = cc.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`company_name7218`.`name`) AS `producing_company`, MIN(`link_type780`.`link`) AS `link_type`, MIN(`title11123`.`title`) AS `complete_western_sequel` FROM `complete_cast` AS `complete_cast1888`, `comp_cast_type` AS `comp_cast_type3215`, `comp_cast_type` AS `comp_cast_type3216`, `company_name` AS `company_name7218`, `company_type` AS `company_type5014`, `keyword` AS `keyword6816`, `link_type` AS `link_type780`, `movie_companies` AS `movie_companies8034`, `movie_info` AS `movie_info5502`, `movie_keyword` AS `movie_keyword6816`, `movie_link` AS `movie_link780`, `title` AS `title11123` WHERE (`comp_cast_type3215`.`kind` = 'cast' OR `comp_cast_type3215`.`kind` = 'crew') AND (`comp_cast_type3216`.`kind` = 'complete' AND `company_name7218`.`country_code` <> '[pl]') AND ((`company_name7218`.`name` LIKE '%Film%' OR `company_name7218`.`name` LIKE '%Warner%') AND `company_type5014`.`kind` = 'production companies' AND (`keyword6816`.`keyword` = 'sequel' AND `link_type780`.`link` LIKE '%follow%')) AND (`movie_companies8034`.`note` IS NULL AND (`movie_info5502`.`info` = 'Sweden' OR `movie_info5502`.`info` = 'Germany' OR `movie_info5502`.`info` = 'Swedish' OR `movie_info5502`.`info` = 'German') AND (`title11123`.`production_year` = 1998 AND `link_type780`.`id` = `movie_link780`.`link_type_id`) AND (`movie_link780`.`movie_id` = `title11123`.`id` AND `title11123`.`id` = `movie_keyword6816`.`movie_id` AND (`movie_keyword6816`.`keyword_id` = `keyword6816`.`id` AND `title11123`.`id` = `movie_companies8034`.`movie_id`))) AND (`movie_companies8034`.`company_type_id` = `company_type5014`.`id` AND `movie_companies8034`.`company_id` = `company_name7218`.`id` AND (`movie_info5502`.`movie_id` = `title11123`.`id` AND `title11123`.`id` = `complete_cast1888`.`movie_id`) AND (`comp_cast_type3215`.`id` = `complete_cast1888`.`subject_id` AND `comp_cast_type3216`.`id` = `complete_cast1888`.`status_id` AND (`movie_link780`.`movie_id` = `movie_keyword6816`.`movie_id` AND `movie_link780`.`movie_id` = `movie_companies8034`.`movie_id`)) AND (`movie_keyword6816`.`movie_id` = `movie_companies8034`.`movie_id` AND `movie_link780`.`movie_id` = `movie_info5502`.`movie_id` AND (`movie_keyword6816`.`movie_id` = `movie_info5502`.`movie_id` AND `movie_companies8034`.`movie_id` = `movie_info5502`.`movie_id`) AND (`movie_link780`.`movie_id` = `complete_cast1888`.`movie_id` AND `movie_keyword6816`.`movie_id` = `complete_cast1888`.`movie_id` AND (`movie_companies8034`.`movie_id` = `complete_cast1888`.`movie_id` AND `movie_info5502`.`movie_id` = `complete_cast1888`.`movie_id`))))
time used(s):5.494, index: 61, origin_cost: 6752.27001953125, rewrite_cost: 6752.18017578125, origin: SELECT MIN(cn.name) AS producing_company, MIN(lt.link) AS link_type, MIN(t.title) AS complete_western_sequel FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, keyword AS k, link_type AS lt, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, movie_link AS ml, title AS t WHERE cct1.kind = 'cast' AND cct2.kind LIKE 'complete%' AND cn.country_code !='[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind ='production companies' AND k.keyword ='sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'English') AND t.production_year BETWEEN 1950 AND 2010 AND lt.id = ml.link_type_id AND ml.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND t.id = mc.movie_id AND mc.company_type_id = ct.id AND mc.company_id = cn.id AND mi.movie_id = t.id AND t.id = cc.movie_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id AND ml.movie_id = mk.movie_id AND ml.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND ml.movie_id = mi.movie_id AND mk.movie_id = mi.movie_id AND mc.movie_id = mi.movie_id AND ml.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND mc.movie_id = cc.movie_id AND mi.movie_id = cc.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`company_name7270`.`name`) AS `producing_company`, MIN(`link_type832`.`link`) AS `link_type`, MIN(`title11226`.`title`) AS `complete_western_sequel` FROM `complete_cast` AS `complete_cast1940`, `comp_cast_type` AS `comp_cast_type3319`, `comp_cast_type` AS `comp_cast_type3320`, `company_name` AS `company_name7270`, `company_type` AS `company_type5066`, `keyword` AS `keyword6868`, `link_type` AS `link_type832`, `movie_companies` AS `movie_companies8086`, `movie_info` AS `movie_info5554`, `movie_keyword` AS `movie_keyword6868`, `movie_link` AS `movie_link832`, `title` AS `title11226` WHERE `comp_cast_type3319`.`kind` = 'cast' AND `comp_cast_type3320`.`kind` LIKE 'complete%' AND (`company_name7270`.`country_code` <> '[pl]' AND (`company_name7270`.`name` LIKE '%Film%' OR `company_name7270`.`name` LIKE '%Warner%')) AND (`company_type5066`.`kind` = 'production companies' AND `keyword6868`.`keyword` = 'sequel' AND (`link_type832`.`link` LIKE '%follow%' AND `movie_companies8086`.`note` IS NULL)) AND ((`movie_info5554`.`info` = 'Sweden' OR `movie_info5554`.`info` = 'Norway' OR (`movie_info5554`.`info` = 'Germany' OR `movie_info5554`.`info` = 'Denmark') OR (`movie_info5554`.`info` = 'Swedish' OR `movie_info5554`.`info` = 'Denish' OR (`movie_info5554`.`info` = 'Norwegian' OR (`movie_info5554`.`info` = 'German' OR `movie_info5554`.`info` = 'English')))) AND `title11226`.`production_year` >= 1950 AND (`title11226`.`production_year` <= 2010 AND `link_type832`.`id` = `movie_link832`.`link_type_id`) AND (`movie_link832`.`movie_id` = `title11226`.`id` AND `title11226`.`id` = `movie_keyword6868`.`movie_id` AND (`movie_keyword6868`.`keyword_id` = `keyword6868`.`id` AND `title11226`.`id` = `movie_companies8086`.`movie_id`))) AND (`movie_companies8086`.`company_type_id` = `company_type5066`.`id` AND `movie_companies8086`.`company_id` = `company_name7270`.`id` AND (`movie_info5554`.`movie_id` = `title11226`.`id` AND `title11226`.`id` = `complete_cast1940`.`movie_id`) AND (`comp_cast_type3319`.`id` = `complete_cast1940`.`subject_id` AND `comp_cast_type3320`.`id` = `complete_cast1940`.`status_id` AND (`movie_link832`.`movie_id` = `movie_keyword6868`.`movie_id` AND `movie_link832`.`movie_id` = `movie_companies8086`.`movie_id`)) AND (`movie_keyword6868`.`movie_id` = `movie_companies8086`.`movie_id` AND `movie_link832`.`movie_id` = `movie_info5554`.`movie_id` AND (`movie_keyword6868`.`movie_id` = `movie_info5554`.`movie_id` AND `movie_companies8086`.`movie_id` = `movie_info5554`.`movie_id`) AND (`movie_link832`.`movie_id` = `complete_cast1940`.`movie_id` AND `movie_keyword6868`.`movie_id` = `complete_cast1940`.`movie_id` AND (`movie_companies8086`.`movie_id` = `complete_cast1940`.`movie_id` AND `movie_info5554`.`movie_id` = `complete_cast1940`.`movie_id`))))
time used(s):18.994, index: 62, origin_cost: 58480.44140625, rewrite_cost: 58480.44140625, origin: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_euro_dark_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cct1.kind = 'crew' AND cct2.kind != 'complete+verified' AND cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mc.note NOT LIKE '%(USA)%' AND mc.note LIKE '%(200%)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info < '8.5' AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = mi_idx.movie_id AND mc.movie_id = cc.movie_id AND mi_idx.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;, rewrite: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_euro_dark_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cct1.kind = 'crew' AND cct2.kind != 'complete+verified' AND cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mc.note NOT LIKE '%(USA)%' AND mc.note LIKE '%(200%)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info < '8.5' AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = mi_idx.movie_id AND mc.movie_id = cc.movie_id AND mi_idx.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;
time used(s):19.36, index: 63, origin_cost: 58445.921875, rewrite_cost: 58445.921875, origin: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_euro_dark_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cct1.kind = 'crew' AND cct2.kind != 'complete+verified' AND cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mc.note NOT LIKE '%(USA)%' AND mc.note LIKE '%(200%)%' AND mi.info IN ('Sweden', 'Germany', 'Swedish', 'German') AND mi_idx.info > '6.5' AND t.production_year > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = mi_idx.movie_id AND mc.movie_id = cc.movie_id AND mi_idx.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;, rewrite: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_euro_dark_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cct1.kind = 'crew' AND cct2.kind != 'complete+verified' AND cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mc.note NOT LIKE '%(USA)%' AND mc.note LIKE '%(200%)%' AND mi.info IN ('Sweden', 'Germany', 'Swedish', 'German') AND mi_idx.info > '6.5' AND t.production_year > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = mi_idx.movie_id AND mc.movie_id = cc.movie_id AND mi_idx.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;
time used(s):19.841, index: 64, origin_cost: 30533.9609375, rewrite_cost: 30533.9609375, origin: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_euro_dark_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cct1.kind = 'cast' AND cct2.kind = 'complete' AND cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mc.note NOT LIKE '%(USA)%' AND mc.note LIKE '%(200%)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info < '8.5' AND t.production_year > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = mi_idx.movie_id AND mc.movie_id = cc.movie_id AND mi_idx.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;, rewrite: SELECT MIN(cn.name) AS movie_company, MIN(mi_idx.info) AS rating, MIN(t.title) AS complete_euro_dark_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, company_name AS cn, company_type AS ct, info_type AS it1, info_type AS it2, keyword AS k, kind_type AS kt, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE cct1.kind = 'cast' AND cct2.kind = 'complete' AND cn.country_code != '[us]' AND it1.info = 'countries' AND it2.info = 'rating' AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND kt.kind IN ('movie', 'episode') AND mc.note NOT LIKE '%(USA)%' AND mc.note LIKE '%(200%)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American') AND mi_idx.info < '8.5' AND t.production_year > 2005 AND kt.id = t.kind_id AND t.id = mi.movie_id AND t.id = mk.movie_id AND t.id = mi_idx.movie_id AND t.id = mc.movie_id AND t.id = cc.movie_id AND mk.movie_id = mi.movie_id AND mk.movie_id = mi_idx.movie_id AND mk.movie_id = mc.movie_id AND mk.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mc.movie_id AND mi.movie_id = cc.movie_id AND mc.movie_id = mi_idx.movie_id AND mc.movie_id = cc.movie_id AND mi_idx.movie_id = cc.movie_id AND k.id = mk.keyword_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND ct.id = mc.company_type_id AND cn.id = mc.company_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;
time used(s):19.072, index: 65, origin_cost: 9599.900390625, rewrite_cost: 9376.8896484375, origin: SELECT MIN(chn.name) AS voiced_char, MIN(n.name) AS voicing_actress, MIN(t.title) AS voiced_animation FROM aka_name AS an, complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, info_type AS it3, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, name AS n, person_info AS pi, role_type AS rt, title AS t WHERE cct1.kind ='cast' AND cct2.kind ='complete+verified' AND chn.name = 'Queen' AND ci.note IN ('(voice)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND it.info = 'release dates' AND it3.info = 'trivia' AND k.keyword = 'computer-animation' AND mi.info IS NOT NULL AND (mi.info LIKE 'Japan:%200%' OR mi.info LIKE 'USA:%200%') AND n.gender ='f' AND n.name LIKE '%An%' AND rt.role ='actress' AND t.title = 'Shrek 2' AND t.production_year BETWEEN 2000 AND 2010 AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = cc.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mc.movie_id = mk.movie_id AND mc.movie_id = cc.movie_id AND mi.movie_id = ci.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = cc.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id AND n.id = pi.person_id AND ci.person_id = pi.person_id AND it3.id = pi.info_type_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`char_name2966`.`name`) AS `voiced_char`, MIN(`name5240`.`name`) AS `voicing_actress`, MIN(`title11991`.`title`) AS `voiced_animation` FROM `aka_name` AS `aka_name1946`, `complete_cast` AS `complete_cast2704`, `comp_cast_type` AS `comp_cast_type4847`, `comp_cast_type` AS `comp_cast_type4848`, `char_name` AS `char_name2966`, `cast_info` AS `cast_info5852`, `company_name` AS `company_name8034`, `info_type` AS `info_type11899`, `info_type` AS `info_type11900`, `keyword` AS `keyword7632`, `movie_companies` AS `movie_companies8850`, `movie_info` AS `movie_info6318`, `movie_keyword` AS `movie_keyword7632`, `name` AS `name5240`, `person_info` AS `person_info150`, `role_type` AS `role_type1742`, `title` AS `title11991` WHERE `comp_cast_type4847`.`kind` = 'cast' AND `comp_cast_type4848`.`kind` = 'complete+verified' AND (`char_name2966`.`name` = 'Queen' AND ((`cast_info5852`.`note` = '(voice)' OR `cast_info5852`.`note` = '(voice) (uncredited)' OR `cast_info5852`.`note` = '(voice: English version)') AND `company_name8034`.`country_code` = '[us]')) AND (`info_type11899`.`info` = 'release dates' AND (`info_type11900`.`info` = 'trivia' AND `keyword7632`.`keyword` = 'computer-animation') AND (`movie_info6318`.`info` IS NOT NULL AND ((`movie_info6318`.`info` LIKE 'Japan:%200%' OR `movie_info6318`.`info` LIKE 'USA:%200%') AND `name5240`.`gender` = 'f'))) AND (`name5240`.`name` LIKE '%An%' AND `role_type1742`.`role` = 'actress' AND (`title11991`.`title` = 'Shrek 2' AND (`title11991`.`production_year` >= 2000 AND `title11991`.`production_year` <= 2010)) AND (`title11991`.`id` = `movie_info6318`.`movie_id` AND (`title11991`.`id` = `movie_companies8850`.`movie_id` AND `title11991`.`id` = `cast_info5852`.`movie_id`) AND (`title11991`.`id` = `movie_keyword7632`.`movie_id` AND (`title11991`.`id` = `complete_cast2704`.`movie_id` AND `movie_companies8850`.`movie_id` = `cast_info5852`.`movie_id`)))) AND (`movie_companies8850`.`movie_id` = `movie_info6318`.`movie_id` AND `movie_companies8850`.`movie_id` = `movie_keyword7632`.`movie_id` AND (`movie_companies8850`.`movie_id` = `complete_cast2704`.`movie_id` AND (`movie_info6318`.`movie_id` = `cast_info5852`.`movie_id` AND `movie_info6318`.`movie_id` = `movie_keyword7632`.`movie_id`)) AND (`movie_info6318`.`movie_id` = `complete_cast2704`.`movie_id` AND (`cast_info5852`.`movie_id` = `movie_keyword7632`.`movie_id` AND `cast_info5852`.`movie_id` = `complete_cast2704`.`movie_id`) AND (`movie_keyword7632`.`movie_id` = `complete_cast2704`.`movie_id` AND (`company_name8034`.`id` = `movie_companies8850`.`company_id` AND `info_type11899`.`id` = `movie_info6318`.`info_type_id`))) AND (`name5240`.`id` = `cast_info5852`.`person_id` AND `role_type1742`.`id` = `cast_info5852`.`role_id` AND (`name5240`.`id` = `aka_name1946`.`person_id` AND (`cast_info5852`.`person_id` = `aka_name1946`.`person_id` AND `char_name2966`.`id` = `cast_info5852`.`person_role_id`)) AND (`name5240`.`id` = `person_info150`.`person_id` AND (`cast_info5852`.`person_id` = `person_info150`.`person_id` AND `info_type11900`.`id` = `person_info150`.`info_type_id`) AND (`keyword7632`.`id` = `movie_keyword7632`.`keyword_id` AND (`comp_cast_type4847`.`id` = `complete_cast2704`.`subject_id` AND `comp_cast_type4848`.`id` = `complete_cast2704`.`status_id`)))))
time used(s):18.792, index: 66, origin_cost: 9599.8701171875, rewrite_cost: 9376.8701171875, origin: SELECT MIN(chn.name) AS voiced_char, MIN(n.name) AS voicing_actress, MIN(t.title) AS voiced_animation FROM aka_name AS an, complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, info_type AS it3, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, name AS n, person_info AS pi, role_type AS rt, title AS t WHERE cct1.kind ='cast' AND cct2.kind ='complete+verified' AND chn.name = 'Queen' AND ci.note IN ('(voice)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND it.info = 'release dates' AND it3.info = 'height' AND k.keyword = 'computer-animation' AND mi.info LIKE 'USA:%200%' AND n.gender ='f' AND n.name LIKE '%An%' AND rt.role ='actress' AND t.title = 'Shrek 2' AND t.production_year BETWEEN 2000 AND 2005 AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = cc.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mc.movie_id = mk.movie_id AND mc.movie_id = cc.movie_id AND mi.movie_id = ci.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = cc.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id AND n.id = pi.person_id AND ci.person_id = pi.person_id AND it3.id = pi.info_type_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`char_name2975`.`name`) AS `voiced_char`, MIN(`name5249`.`name`) AS `voicing_actress`, MIN(`title12000`.`title`) AS `voiced_animation` FROM `aka_name` AS `aka_name1955`, `complete_cast` AS `complete_cast2713`, `comp_cast_type` AS `comp_cast_type4865`, `comp_cast_type` AS `comp_cast_type4866`, `char_name` AS `char_name2975`, `cast_info` AS `cast_info5861`, `company_name` AS `company_name8043`, `info_type` AS `info_type11917`, `info_type` AS `info_type11918`, `keyword` AS `keyword7641`, `movie_companies` AS `movie_companies8859`, `movie_info` AS `movie_info6327`, `movie_keyword` AS `movie_keyword7641`, `name` AS `name5249`, `person_info` AS `person_info159`, `role_type` AS `role_type1751`, `title` AS `title12000` WHERE `comp_cast_type4865`.`kind` = 'cast' AND `comp_cast_type4866`.`kind` = 'complete+verified' AND (`char_name2975`.`name` = 'Queen' AND ((`cast_info5861`.`note` = '(voice)' OR `cast_info5861`.`note` = '(voice) (uncredited)' OR `cast_info5861`.`note` = '(voice: English version)') AND `company_name8043`.`country_code` = '[us]')) AND (`info_type11917`.`info` = 'release dates' AND `info_type11918`.`info` = 'height' AND (`keyword7641`.`keyword` = 'computer-animation' AND (`movie_info6327`.`info` LIKE 'USA:%200%' AND `name5249`.`gender` = 'f'))) AND (`name5249`.`name` LIKE '%An%' AND `role_type1751`.`role` = 'actress' AND (`title12000`.`title` = 'Shrek 2' AND (`title12000`.`production_year` >= 2000 AND `title12000`.`production_year` <= 2005)) AND (`title12000`.`id` = `movie_info6327`.`movie_id` AND (`title12000`.`id` = `movie_companies8859`.`movie_id` AND `title12000`.`id` = `cast_info5861`.`movie_id`) AND (`title12000`.`id` = `movie_keyword7641`.`movie_id` AND (`title12000`.`id` = `complete_cast2713`.`movie_id` AND `movie_companies8859`.`movie_id` = `cast_info5861`.`movie_id`)))) AND (`movie_companies8859`.`movie_id` = `movie_info6327`.`movie_id` AND `movie_companies8859`.`movie_id` = `movie_keyword7641`.`movie_id` AND (`movie_companies8859`.`movie_id` = `complete_cast2713`.`movie_id` AND (`movie_info6327`.`movie_id` = `cast_info5861`.`movie_id` AND `movie_info6327`.`movie_id` = `movie_keyword7641`.`movie_id`)) AND (`movie_info6327`.`movie_id` = `complete_cast2713`.`movie_id` AND (`cast_info5861`.`movie_id` = `movie_keyword7641`.`movie_id` AND `cast_info5861`.`movie_id` = `complete_cast2713`.`movie_id`) AND (`movie_keyword7641`.`movie_id` = `complete_cast2713`.`movie_id` AND (`company_name8043`.`id` = `movie_companies8859`.`company_id` AND `info_type11917`.`id` = `movie_info6327`.`info_type_id`))) AND (`name5249`.`id` = `cast_info5861`.`person_id` AND `role_type1751`.`id` = `cast_info5861`.`role_id` AND (`name5249`.`id` = `aka_name1955`.`person_id` AND (`cast_info5861`.`person_id` = `aka_name1955`.`person_id` AND `char_name2975`.`id` = `cast_info5861`.`person_role_id`)) AND (`name5249`.`id` = `person_info159`.`person_id` AND (`cast_info5861`.`person_id` = `person_info159`.`person_id` AND `info_type11918`.`id` = `person_info159`.`info_type_id`) AND (`keyword7641`.`id` = `movie_keyword7641`.`keyword_id` AND (`comp_cast_type4865`.`id` = `complete_cast2713`.`subject_id` AND `comp_cast_type4866`.`id` = `complete_cast2713`.`status_id`)))))
time used(s):23.551, index: 67, origin_cost: 10725.400390625, rewrite_cost: 10243.9404296875, origin: SELECT MIN(chn.name) AS voiced_char, MIN(n.name) AS voicing_actress, MIN(t.title) AS voiced_animation FROM aka_name AS an, complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, company_name AS cn, info_type AS it, info_type AS it3, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_keyword AS mk, name AS n, person_info AS pi, role_type AS rt, title AS t WHERE cct1.kind ='cast' AND cct2.kind ='complete+verified' AND ci.note IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND it.info = 'release dates' AND it3.info = 'trivia' AND k.keyword = 'computer-animation' AND mi.info IS NOT NULL AND (mi.info LIKE 'Japan:%200%' OR mi.info LIKE 'USA:%200%') AND n.gender ='f' AND n.name LIKE '%An%' AND rt.role ='actress' AND t.production_year BETWEEN 2000 AND 2010 AND t.id = mi.movie_id AND t.id = mc.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = cc.movie_id AND mc.movie_id = ci.movie_id AND mc.movie_id = mi.movie_id AND mc.movie_id = mk.movie_id AND mc.movie_id = cc.movie_id AND mi.movie_id = ci.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = cc.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND cn.id = mc.company_id AND it.id = mi.info_type_id AND n.id = ci.person_id AND rt.id = ci.role_id AND n.id = an.person_id AND ci.person_id = an.person_id AND chn.id = ci.person_role_id AND n.id = pi.person_id AND ci.person_id = pi.person_id AND it3.id = pi.info_type_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`char_name3282`.`name`) AS `voiced_char`, MIN(`name5556`.`name`) AS `voicing_actress`, MIN(`title12307`.`title`) AS `voiced_animation` FROM `aka_name` AS `aka_name2262`, `complete_cast` AS `complete_cast3020`, `comp_cast_type` AS `comp_cast_type5479`, `comp_cast_type` AS `comp_cast_type5480`, `char_name` AS `char_name3282`, `cast_info` AS `cast_info6168`, `company_name` AS `company_name8350`, `info_type` AS `info_type12531`, `info_type` AS `info_type12532`, `keyword` AS `keyword7948`, `movie_companies` AS `movie_companies9166`, `movie_info` AS `movie_info6634`, `movie_keyword` AS `movie_keyword7948`, `name` AS `name5556`, `person_info` AS `person_info466`, `role_type` AS `role_type2058`, `title` AS `title12307` WHERE `comp_cast_type5479`.`kind` = 'cast' AND `comp_cast_type5480`.`kind` = 'complete+verified' AND ((`cast_info6168`.`note` = '(voice)' OR `cast_info6168`.`note` = '(voice: Japanese version)' OR `cast_info6168`.`note` = '(voice) (uncredited)' OR `cast_info6168`.`note` = '(voice: English version)') AND (`company_name8350`.`country_code` = '[us]' AND `info_type12531`.`info` = 'release dates')) AND (`info_type12532`.`info` = 'trivia' AND `keyword7948`.`keyword` = 'computer-animation' AND (`movie_info6634`.`info` IS NOT NULL AND ((`movie_info6634`.`info` LIKE 'Japan:%200%' OR `movie_info6634`.`info` LIKE 'USA:%200%') AND `name5556`.`gender` = 'f'))) AND (`name5556`.`name` LIKE '%An%' AND `role_type2058`.`role` = 'actress' AND (`title12307`.`production_year` >= 2000 AND (`title12307`.`production_year` <= 2010 AND `title12307`.`id` = `movie_info6634`.`movie_id`)) AND (`title12307`.`id` = `movie_companies9166`.`movie_id` AND (`title12307`.`id` = `cast_info6168`.`movie_id` AND `title12307`.`id` = `movie_keyword7948`.`movie_id`) AND (`title12307`.`id` = `complete_cast3020`.`movie_id` AND (`movie_companies9166`.`movie_id` = `cast_info6168`.`movie_id` AND `movie_companies9166`.`movie_id` = `movie_info6634`.`movie_id`)))) AND (`movie_companies9166`.`movie_id` = `movie_keyword7948`.`movie_id` AND `movie_companies9166`.`movie_id` = `complete_cast3020`.`movie_id` AND (`movie_info6634`.`movie_id` = `cast_info6168`.`movie_id` AND (`movie_info6634`.`movie_id` = `movie_keyword7948`.`movie_id` AND `movie_info6634`.`movie_id` = `complete_cast3020`.`movie_id`)) AND (`cast_info6168`.`movie_id` = `movie_keyword7948`.`movie_id` AND `cast_info6168`.`movie_id` = `complete_cast3020`.`movie_id` AND (`movie_keyword7948`.`movie_id` = `complete_cast3020`.`movie_id` AND (`company_name8350`.`id` = `movie_companies9166`.`company_id` AND `info_type12531`.`id` = `movie_info6634`.`info_type_id`))) AND (`name5556`.`id` = `cast_info6168`.`person_id` AND `role_type2058`.`id` = `cast_info6168`.`role_id` AND (`name5556`.`id` = `aka_name2262`.`person_id` AND (`cast_info6168`.`person_id` = `aka_name2262`.`person_id` AND `char_name3282`.`id` = `cast_info6168`.`person_role_id`)) AND (`name5556`.`id` = `person_info466`.`person_id` AND (`cast_info6168`.`person_id` = `person_info466`.`person_id` AND `info_type12532`.`id` = `person_info466`.`info_type_id`) AND (`keyword7948`.`id` = `movie_keyword7948`.`keyword_id` AND (`comp_cast_type5479`.`id` = `complete_cast3020`.`subject_id` AND `comp_cast_type5480`.`id` = `complete_cast3020`.`status_id`)))))
time used(s):12.039, index: 68, origin_cost: 3364888.25, rewrite_cost: 3364888.25, origin: SELECT MIN(t.title) AS movie_title FROM company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, title AS t WHERE cn.country_code ='[de]' AND k.keyword ='character-name-in-title' AND cn.id = mc.company_id AND mc.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(t.title) AS movie_title FROM company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, title AS t WHERE cn.country_code ='[de]' AND k.keyword ='character-name-in-title' AND cn.id = mc.company_id AND mc.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND mc.movie_id = mk.movie_id;
time used(s):11.534, index: 69, origin_cost: 3364888.25, rewrite_cost: 3364888.25, origin: SELECT MIN(t.title) AS movie_title FROM company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, title AS t WHERE cn.country_code ='[nl]' AND k.keyword ='character-name-in-title' AND cn.id = mc.company_id AND mc.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(t.title) AS movie_title FROM company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, title AS t WHERE cn.country_code ='[nl]' AND k.keyword ='character-name-in-title' AND cn.id = mc.company_id AND mc.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND mc.movie_id = mk.movie_id;
time used(s):11.572, index: 70, origin_cost: 3364888.25, rewrite_cost: 3364888.25, origin: SELECT MIN(t.title) AS movie_title FROM company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, title AS t WHERE cn.country_code ='[sm]' AND k.keyword ='character-name-in-title' AND cn.id = mc.company_id AND mc.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(t.title) AS movie_title FROM company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, title AS t WHERE cn.country_code ='[sm]' AND k.keyword ='character-name-in-title' AND cn.id = mc.company_id AND mc.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND mc.movie_id = mk.movie_id;
time used(s):12.992, index: 71, origin_cost: 3364888.25, rewrite_cost: 3364888.25, origin: SELECT MIN(t.title) AS movie_title FROM company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND cn.id = mc.company_id AND mc.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND mc.movie_id = mk.movie_id;, rewrite: SELECT MIN(t.title) AS movie_title FROM company_name AS cn, keyword AS k, movie_companies AS mc, movie_keyword AS mk, title AS t WHERE cn.country_code ='[us]' AND k.keyword ='character-name-in-title' AND cn.id = mc.company_id AND mc.movie_id = t.id AND t.id = mk.movie_id AND mk.keyword_id = k.id AND mc.movie_id = mk.movie_id;
time used(s):13.35, index: 72, origin_cost: 64019.5703125, rewrite_cost: 56138.03125, origin: SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS writer, MIN(t.title) AS complete_violent_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, cast_info AS ci, info_type AS it1, info_type AS it2, keyword AS k, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind IN ('cast', 'crew') AND cct2.kind ='complete+verified' AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info = 'genres' AND it2.info = 'votes' AND k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mi.info IN ('Horror', 'Thriller') AND n.gender = 'm' AND t.production_year > 2000 AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = cc.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = cc.movie_id AND mi_idx.movie_id = mk.movie_id AND mi_idx.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info6786`.`info`) AS `movie_budget`, MIN(`movie_info_idx5892`.`info`) AS `movie_votes`, MIN(`name5708`.`name`) AS `writer`, MIN(`title13275`.`title`) AS `complete_violent_movie` FROM `complete_cast` AS `complete_cast3172`, `comp_cast_type` AS `comp_cast_type5783`, `comp_cast_type` AS `comp_cast_type5784`, `cast_info` AS `cast_info6320`, `info_type` AS `info_type12835`, `info_type` AS `info_type12836`, `keyword` AS `keyword8916`, `movie_info` AS `movie_info6786`, `movie_info_idx` AS `movie_info_idx5892`, `movie_keyword` AS `movie_keyword8916`, `name` AS `name5708`, `title` AS `title13275` WHERE (`comp_cast_type5783`.`kind` = 'cast' OR `comp_cast_type5783`.`kind` = 'crew') AND (`comp_cast_type5784`.`kind` = 'complete+verified' AND (`cast_info6320`.`note` = '(writer)' OR `cast_info6320`.`note` = '(head writer)' OR `cast_info6320`.`note` = '(written by)' OR `cast_info6320`.`note` = '(story)' OR `cast_info6320`.`note` = '(story editor)')) AND (`info_type12835`.`info` = 'genres' AND `info_type12836`.`info` = 'votes' AND ((`keyword8916`.`keyword` = 'murder' OR (`keyword8916`.`keyword` = 'violence' OR `keyword8916`.`keyword` = 'blood') OR (`keyword8916`.`keyword` = 'gore' OR `keyword8916`.`keyword` = 'death' OR (`keyword8916`.`keyword` = 'female-nudity' OR `keyword8916`.`keyword` = 'hospital'))) AND (`movie_info6786`.`info` = 'Horror' OR `movie_info6786`.`info` = 'Thriller'))) AND (`name5708`.`gender` = 'm' AND `title13275`.`production_year` > 2000 AND (`title13275`.`id` = `movie_info6786`.`movie_id` AND `title13275`.`id` = `movie_info_idx5892`.`movie_id`) AND (`title13275`.`id` = `cast_info6320`.`movie_id` AND `title13275`.`id` = `movie_keyword8916`.`movie_id` AND (`title13275`.`id` = `complete_cast3172`.`movie_id` AND `cast_info6320`.`movie_id` = `movie_info6786`.`movie_id`))) AND (`cast_info6320`.`movie_id` = `movie_info_idx5892`.`movie_id` AND (`cast_info6320`.`movie_id` = `movie_keyword8916`.`movie_id` AND `cast_info6320`.`movie_id` = `complete_cast3172`.`movie_id`) AND (`movie_info6786`.`movie_id` = `movie_info_idx5892`.`movie_id` AND `movie_info6786`.`movie_id` = `movie_keyword8916`.`movie_id` AND (`movie_info6786`.`movie_id` = `complete_cast3172`.`movie_id` AND `movie_info_idx5892`.`movie_id` = `movie_keyword8916`.`movie_id`)) AND (`movie_info_idx5892`.`movie_id` = `complete_cast3172`.`movie_id` AND `movie_keyword8916`.`movie_id` = `complete_cast3172`.`movie_id` AND (`name5708`.`id` = `cast_info6320`.`person_id` AND `info_type12835`.`id` = `movie_info6786`.`info_type_id`) AND (`info_type12836`.`id` = `movie_info_idx5892`.`info_type_id` AND `keyword8916`.`id` = `movie_keyword8916`.`keyword_id` AND (`comp_cast_type5783`.`id` = `complete_cast3172`.`subject_id` AND `comp_cast_type5784`.`id` = `complete_cast3172`.`status_id`))))
time used(s):14.842, index: 73, origin_cost: 56011.80859375, rewrite_cost: 51517.73046875, origin: SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS writer, MIN(t.title) AS complete_gore_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, cast_info AS ci, info_type AS it1, info_type AS it2, keyword AS k, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind IN ('cast', 'crew') AND cct2.kind ='complete+verified' AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info = 'genres' AND it2.info = 'votes' AND k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mi.info IN ('Horror', 'Thriller') AND n.gender = 'm' AND t.production_year > 2000 AND (t.title LIKE '%Freddy%' OR t.title LIKE '%Jason%' OR t.title LIKE 'Saw%') AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = cc.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = cc.movie_id AND mi_idx.movie_id = mk.movie_id AND mi_idx.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info6940`.`info`) AS `movie_budget`, MIN(`movie_info_idx6046`.`info`) AS `movie_votes`, MIN(`name5862`.`name`) AS `writer`, MIN(`title13429`.`title`) AS `complete_gore_movie` FROM `complete_cast` AS `complete_cast3326`, `comp_cast_type` AS `comp_cast_type6091`, `comp_cast_type` AS `comp_cast_type6092`, `cast_info` AS `cast_info6474`, `info_type` AS `info_type13143`, `info_type` AS `info_type13144`, `keyword` AS `keyword9070`, `movie_info` AS `movie_info6940`, `movie_info_idx` AS `movie_info_idx6046`, `movie_keyword` AS `movie_keyword9070`, `name` AS `name5862`, `title` AS `title13429` WHERE (`comp_cast_type6091`.`kind` = 'cast' OR `comp_cast_type6091`.`kind` = 'crew') AND (`comp_cast_type6092`.`kind` = 'complete+verified' AND (`cast_info6474`.`note` = '(writer)' OR `cast_info6474`.`note` = '(head writer)' OR `cast_info6474`.`note` = '(written by)' OR `cast_info6474`.`note` = '(story)' OR `cast_info6474`.`note` = '(story editor)')) AND (`info_type13143`.`info` = 'genres' AND `info_type13144`.`info` = 'votes' AND ((`keyword9070`.`keyword` = 'murder' OR (`keyword9070`.`keyword` = 'violence' OR `keyword9070`.`keyword` = 'blood') OR (`keyword9070`.`keyword` = 'gore' OR `keyword9070`.`keyword` = 'death' OR (`keyword9070`.`keyword` = 'female-nudity' OR `keyword9070`.`keyword` = 'hospital'))) AND (`movie_info6940`.`info` = 'Horror' OR `movie_info6940`.`info` = 'Thriller'))) AND (`name5862`.`gender` = 'm' AND `title13429`.`production_year` > 2000 AND ((`title13429`.`title` LIKE '%Freddy%' OR `title13429`.`title` LIKE '%Jason%' OR `title13429`.`title` LIKE 'Saw%') AND `title13429`.`id` = `movie_info6940`.`movie_id`) AND (`title13429`.`id` = `movie_info_idx6046`.`movie_id` AND `title13429`.`id` = `cast_info6474`.`movie_id` AND (`title13429`.`id` = `movie_keyword9070`.`movie_id` AND `title13429`.`id` = `complete_cast3326`.`movie_id`))) AND (`cast_info6474`.`movie_id` = `movie_info6940`.`movie_id` AND `cast_info6474`.`movie_id` = `movie_info_idx6046`.`movie_id` AND (`cast_info6474`.`movie_id` = `movie_keyword9070`.`movie_id` AND `cast_info6474`.`movie_id` = `complete_cast3326`.`movie_id`) AND (`movie_info6940`.`movie_id` = `movie_info_idx6046`.`movie_id` AND `movie_info6940`.`movie_id` = `movie_keyword9070`.`movie_id` AND (`movie_info6940`.`movie_id` = `complete_cast3326`.`movie_id` AND `movie_info_idx6046`.`movie_id` = `movie_keyword9070`.`movie_id`)) AND (`movie_info_idx6046`.`movie_id` = `complete_cast3326`.`movie_id` AND `movie_keyword9070`.`movie_id` = `complete_cast3326`.`movie_id` AND (`name5862`.`id` = `cast_info6474`.`person_id` AND `info_type13143`.`id` = `movie_info6940`.`info_type_id`) AND (`info_type13144`.`id` = `movie_info_idx6046`.`info_type_id` AND `keyword9070`.`id` = `movie_keyword9070`.`keyword_id` AND (`comp_cast_type6091`.`id` = `complete_cast3326`.`subject_id` AND `comp_cast_type6092`.`id` = `complete_cast3326`.`status_id`))))
time used(s):13.72, index: 74, origin_cost: 44395.01953125, rewrite_cost: 43826.01953125, origin: SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS writer, MIN(t.title) AS complete_violent_movie FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, cast_info AS ci, info_type AS it1, info_type AS it2, keyword AS k, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = 'cast' AND cct2.kind ='complete+verified' AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND it1.info = 'genres' AND it2.info = 'votes' AND k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mi.info IN ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War') AND n.gender = 'm' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = cc.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = cc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = cc.movie_id AND mi_idx.movie_id = mk.movie_id AND mi_idx.movie_id = cc.movie_id AND mk.movie_id = cc.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info7097`.`info`) AS `movie_budget`, MIN(`movie_info_idx6203`.`info`) AS `movie_votes`, MIN(`name6019`.`name`) AS `writer`, MIN(`title13586`.`title`) AS `complete_violent_movie` FROM `complete_cast` AS `complete_cast3483`, `comp_cast_type` AS `comp_cast_type6405`, `comp_cast_type` AS `comp_cast_type6406`, `cast_info` AS `cast_info6631`, `info_type` AS `info_type13457`, `info_type` AS `info_type13458`, `keyword` AS `keyword9227`, `movie_info` AS `movie_info7097`, `movie_info_idx` AS `movie_info_idx6203`, `movie_keyword` AS `movie_keyword9227`, `name` AS `name6019`, `title` AS `title13586` WHERE `comp_cast_type6405`.`kind` = 'cast' AND (`comp_cast_type6406`.`kind` = 'complete+verified' AND (`cast_info6631`.`note` = '(writer)' OR `cast_info6631`.`note` = '(head writer)' OR `cast_info6631`.`note` = '(written by)' OR `cast_info6631`.`note` = '(story)' OR `cast_info6631`.`note` = '(story editor)')) AND (`info_type13457`.`info` = 'genres' AND `info_type13458`.`info` = 'votes' AND ((`keyword9227`.`keyword` = 'murder' OR (`keyword9227`.`keyword` = 'violence' OR `keyword9227`.`keyword` = 'blood') OR (`keyword9227`.`keyword` = 'gore' OR `keyword9227`.`keyword` = 'death' OR (`keyword9227`.`keyword` = 'female-nudity' OR `keyword9227`.`keyword` = 'hospital'))) AND (`movie_info7097`.`info` = 'Horror' OR (`movie_info7097`.`info` = 'Action' OR `movie_info7097`.`info` = 'Sci-Fi') OR (`movie_info7097`.`info` = 'Thriller' OR (`movie_info7097`.`info` = 'Crime' OR `movie_info7097`.`info` = 'War'))))) AND (`name6019`.`gender` = 'm' AND (`title13586`.`id` = `movie_info7097`.`movie_id` AND `title13586`.`id` = `movie_info_idx6203`.`movie_id`) AND (`title13586`.`id` = `cast_info6631`.`movie_id` AND `title13586`.`id` = `movie_keyword9227`.`movie_id` AND (`title13586`.`id` = `complete_cast3483`.`movie_id` AND `cast_info6631`.`movie_id` = `movie_info7097`.`movie_id`))) AND (`cast_info6631`.`movie_id` = `movie_info_idx6203`.`movie_id` AND (`cast_info6631`.`movie_id` = `movie_keyword9227`.`movie_id` AND `cast_info6631`.`movie_id` = `complete_cast3483`.`movie_id`) AND (`movie_info7097`.`movie_id` = `movie_info_idx6203`.`movie_id` AND `movie_info7097`.`movie_id` = `movie_keyword9227`.`movie_id` AND (`movie_info7097`.`movie_id` = `complete_cast3483`.`movie_id` AND `movie_info_idx6203`.`movie_id` = `movie_keyword9227`.`movie_id`)) AND (`movie_info_idx6203`.`movie_id` = `complete_cast3483`.`movie_id` AND `movie_keyword9227`.`movie_id` = `complete_cast3483`.`movie_id` AND (`name6019`.`id` = `cast_info6631`.`person_id` AND `info_type13457`.`id` = `movie_info7097`.`info_type_id`) AND (`info_type13458`.`id` = `movie_info_idx6203`.`info_type_id` AND `keyword9227`.`id` = `movie_keyword9227`.`keyword_id` AND (`comp_cast_type6405`.`id` = `complete_cast3483`.`subject_id` AND `comp_cast_type6406`.`id` = `complete_cast3483`.`status_id`))))
time used(s):12.828, index: 75, origin_cost: 3178864.75, rewrite_cost: 3145209.75, origin: SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS writer, MIN(t.title) AS violent_liongate_movie FROM cast_info AS ci, company_name AS cn, info_type AS it1, info_type AS it2, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND cn.name LIKE 'Lionsgate%' AND it1.info = 'genres' AND it2.info = 'votes' AND k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mi.info IN ('Horror', 'Thriller') AND n.gender = 'm' AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = mc.movie_id AND mi_idx.movie_id = mk.movie_id AND mi_idx.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id AND cn.id = mc.company_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info7253`.`info`) AS `movie_budget`, MIN(`movie_info_idx6359`.`info`) AS `movie_votes`, MIN(`name6175`.`name`) AS `writer`, MIN(`title13742`.`title`) AS `violent_liongate_movie` FROM `cast_info` AS `cast_info6787`, `company_name` AS `company_name9320`, `info_type` AS `info_type13769`, `info_type` AS `info_type13770`, `keyword` AS `keyword9383`, `movie_companies` AS `movie_companies10136`, `movie_info` AS `movie_info7253`, `movie_info_idx` AS `movie_info_idx6359`, `movie_keyword` AS `movie_keyword9383`, `name` AS `name6175`, `title` AS `title13742` WHERE (`cast_info6787`.`note` = '(writer)' OR `cast_info6787`.`note` = '(head writer)' OR `cast_info6787`.`note` = '(written by)' OR `cast_info6787`.`note` = '(story)' OR `cast_info6787`.`note` = '(story editor)') AND (`company_name9320`.`name` LIKE 'Lionsgate%' AND `info_type13769`.`info` = 'genres') AND (`info_type13770`.`info` = 'votes' AND ((`keyword9383`.`keyword` = 'murder' OR (`keyword9383`.`keyword` = 'violence' OR `keyword9383`.`keyword` = 'blood') OR (`keyword9383`.`keyword` = 'gore' OR `keyword9383`.`keyword` = 'death' OR (`keyword9383`.`keyword` = 'female-nudity' OR `keyword9383`.`keyword` = 'hospital'))) AND (`movie_info7253`.`info` = 'Horror' OR `movie_info7253`.`info` = 'Thriller'))) AND (`name6175`.`gender` = 'm' AND (`title13742`.`id` = `movie_info7253`.`movie_id` AND `title13742`.`id` = `movie_info_idx6359`.`movie_id`) AND (`title13742`.`id` = `cast_info6787`.`movie_id` AND `title13742`.`id` = `movie_keyword9383`.`movie_id` AND (`title13742`.`id` = `movie_companies10136`.`movie_id` AND `cast_info6787`.`movie_id` = `movie_info7253`.`movie_id`))) AND (`cast_info6787`.`movie_id` = `movie_info_idx6359`.`movie_id` AND (`cast_info6787`.`movie_id` = `movie_keyword9383`.`movie_id` AND `cast_info6787`.`movie_id` = `movie_companies10136`.`movie_id`) AND (`movie_info7253`.`movie_id` = `movie_info_idx6359`.`movie_id` AND `movie_info7253`.`movie_id` = `movie_keyword9383`.`movie_id` AND (`movie_info7253`.`movie_id` = `movie_companies10136`.`movie_id` AND `movie_info_idx6359`.`movie_id` = `movie_keyword9383`.`movie_id`)) AND (`movie_info_idx6359`.`movie_id` = `movie_companies10136`.`movie_id` AND (`movie_keyword9383`.`movie_id` = `movie_companies10136`.`movie_id` AND `name6175`.`id` = `cast_info6787`.`person_id`) AND (`info_type13769`.`id` = `movie_info7253`.`info_type_id` AND `info_type13770`.`id` = `movie_info_idx6359`.`info_type_id` AND (`keyword9383`.`id` = `movie_keyword9383`.`keyword_id` AND `company_name9320`.`id` = `movie_companies10136`.`company_id`))))
time used(s):14.304, index: 76, origin_cost: 577749.875, rewrite_cost: 576723.875, origin: SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS writer, MIN(t.title) AS violent_liongate_movie FROM cast_info AS ci, company_name AS cn, info_type AS it1, info_type AS it2, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND cn.name LIKE 'Lionsgate%' AND it1.info = 'genres' AND it2.info = 'votes' AND k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mc.note LIKE '%(Blu-ray)%' AND mi.info IN ('Horror', 'Thriller') AND n.gender = 'm' AND t.production_year > 2000 AND (t.title LIKE '%Freddy%' OR t.title LIKE '%Jason%' OR t.title LIKE 'Saw%') AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = mc.movie_id AND mi_idx.movie_id = mk.movie_id AND mi_idx.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id AND cn.id = mc.company_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info7258`.`info`) AS `movie_budget`, MIN(`movie_info_idx6364`.`info`) AS `movie_votes`, MIN(`name6180`.`name`) AS `writer`, MIN(`title13747`.`title`) AS `violent_liongate_movie` FROM `cast_info` AS `cast_info6792`, `company_name` AS `company_name9325`, `info_type` AS `info_type13779`, `info_type` AS `info_type13780`, `keyword` AS `keyword9388`, `movie_companies` AS `movie_companies10141`, `movie_info` AS `movie_info7258`, `movie_info_idx` AS `movie_info_idx6364`, `movie_keyword` AS `movie_keyword9388`, `name` AS `name6180`, `title` AS `title13747` WHERE (`cast_info6792`.`note` = '(writer)' OR `cast_info6792`.`note` = '(head writer)' OR `cast_info6792`.`note` = '(written by)' OR `cast_info6792`.`note` = '(story)' OR `cast_info6792`.`note` = '(story editor)') AND (`company_name9325`.`name` LIKE 'Lionsgate%' AND `info_type13779`.`info` = 'genres') AND (`info_type13780`.`info` = 'votes' AND (`keyword9388`.`keyword` = 'murder' OR (`keyword9388`.`keyword` = 'violence' OR `keyword9388`.`keyword` = 'blood') OR (`keyword9388`.`keyword` = 'gore' OR `keyword9388`.`keyword` = 'death' OR (`keyword9388`.`keyword` = 'female-nudity' OR `keyword9388`.`keyword` = 'hospital'))) AND (`movie_companies10141`.`note` LIKE '%(Blu-ray)%' AND (`movie_info7258`.`info` = 'Horror' OR `movie_info7258`.`info` = 'Thriller'))) AND (`name6180`.`gender` = 'm' AND `title13747`.`production_year` > 2000 AND ((`title13747`.`title` LIKE '%Freddy%' OR `title13747`.`title` LIKE '%Jason%' OR `title13747`.`title` LIKE 'Saw%') AND `title13747`.`id` = `movie_info7258`.`movie_id`) AND (`title13747`.`id` = `movie_info_idx6364`.`movie_id` AND `title13747`.`id` = `cast_info6792`.`movie_id` AND (`title13747`.`id` = `movie_keyword9388`.`movie_id` AND `title13747`.`id` = `movie_companies10141`.`movie_id`))) AND (`cast_info6792`.`movie_id` = `movie_info7258`.`movie_id` AND (`cast_info6792`.`movie_id` = `movie_info_idx6364`.`movie_id` AND `cast_info6792`.`movie_id` = `movie_keyword9388`.`movie_id`) AND (`cast_info6792`.`movie_id` = `movie_companies10141`.`movie_id` AND `movie_info7258`.`movie_id` = `movie_info_idx6364`.`movie_id` AND (`movie_info7258`.`movie_id` = `movie_keyword9388`.`movie_id` AND `movie_info7258`.`movie_id` = `movie_companies10141`.`movie_id`)) AND (`movie_info_idx6364`.`movie_id` = `movie_keyword9388`.`movie_id` AND `movie_info_idx6364`.`movie_id` = `movie_companies10141`.`movie_id` AND (`movie_keyword9388`.`movie_id` = `movie_companies10141`.`movie_id` AND `name6180`.`id` = `cast_info6792`.`person_id`) AND (`info_type13779`.`id` = `movie_info7258`.`info_type_id` AND `info_type13780`.`id` = `movie_info_idx6364`.`info_type_id` AND (`keyword9388`.`id` = `movie_keyword9388`.`keyword_id` AND `company_name9325`.`id` = `movie_companies10141`.`company_id`))))
time used(s):13.105, index: 77, origin_cost: 4527649.0, rewrite_cost: 4407811.0, origin: SELECT MIN(mi.info) AS movie_budget, MIN(mi_idx.info) AS movie_votes, MIN(n.name) AS writer, MIN(t.title) AS violent_liongate_movie FROM cast_info AS ci, company_name AS cn, info_type AS it1, info_type AS it2, keyword AS k, movie_companies AS mc, movie_info AS mi, movie_info_idx AS mi_idx, movie_keyword AS mk, name AS n, title AS t WHERE ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') AND cn.name LIKE 'Lionsgate%' AND it1.info = 'genres' AND it2.info = 'votes' AND k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND mi.info IN ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War') AND t.id = mi.movie_id AND t.id = mi_idx.movie_id AND t.id = ci.movie_id AND t.id = mk.movie_id AND t.id = mc.movie_id AND ci.movie_id = mi.movie_id AND ci.movie_id = mi_idx.movie_id AND ci.movie_id = mk.movie_id AND ci.movie_id = mc.movie_id AND mi.movie_id = mi_idx.movie_id AND mi.movie_id = mk.movie_id AND mi.movie_id = mc.movie_id AND mi_idx.movie_id = mk.movie_id AND mi_idx.movie_id = mc.movie_id AND mk.movie_id = mc.movie_id AND n.id = ci.person_id AND it1.id = mi.info_type_id AND it2.id = mi_idx.info_type_id AND k.id = mk.keyword_id AND cn.id = mc.company_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`movie_info7566`.`info`) AS `movie_budget`, MIN(`movie_info_idx6672`.`info`) AS `movie_votes`, MIN(`name6488`.`name`) AS `writer`, MIN(`title14055`.`title`) AS `violent_liongate_movie` FROM `cast_info` AS `cast_info7100`, `company_name` AS `company_name9633`, `info_type` AS `info_type14395`, `info_type` AS `info_type14396`, `keyword` AS `keyword9696`, `movie_companies` AS `movie_companies10449`, `movie_info` AS `movie_info7566`, `movie_info_idx` AS `movie_info_idx6672`, `movie_keyword` AS `movie_keyword9696`, `name` AS `name6488`, `title` AS `title14055` WHERE (`cast_info7100`.`note` = '(writer)' OR `cast_info7100`.`note` = '(head writer)' OR `cast_info7100`.`note` = '(written by)' OR `cast_info7100`.`note` = '(story)' OR `cast_info7100`.`note` = '(story editor)') AND (`company_name9633`.`name` LIKE 'Lionsgate%' AND `info_type14395`.`info` = 'genres') AND (`info_type14396`.`info` = 'votes' AND ((`keyword9696`.`keyword` = 'murder' OR (`keyword9696`.`keyword` = 'violence' OR `keyword9696`.`keyword` = 'blood') OR (`keyword9696`.`keyword` = 'gore' OR `keyword9696`.`keyword` = 'death' OR (`keyword9696`.`keyword` = 'female-nudity' OR `keyword9696`.`keyword` = 'hospital'))) AND (`movie_info7566`.`info` = 'Horror' OR (`movie_info7566`.`info` = 'Action' OR `movie_info7566`.`info` = 'Sci-Fi') OR (`movie_info7566`.`info` = 'Thriller' OR (`movie_info7566`.`info` = 'Crime' OR `movie_info7566`.`info` = 'War'))))) AND (`title14055`.`id` = `movie_info7566`.`movie_id` AND (`title14055`.`id` = `movie_info_idx6672`.`movie_id` AND `title14055`.`id` = `cast_info7100`.`movie_id`) AND (`title14055`.`id` = `movie_keyword9696`.`movie_id` AND `title14055`.`id` = `movie_companies10449`.`movie_id` AND (`cast_info7100`.`movie_id` = `movie_info7566`.`movie_id` AND `cast_info7100`.`movie_id` = `movie_info_idx6672`.`movie_id`))) AND (`cast_info7100`.`movie_id` = `movie_keyword9696`.`movie_id` AND (`cast_info7100`.`movie_id` = `movie_companies10449`.`movie_id` AND `movie_info7566`.`movie_id` = `movie_info_idx6672`.`movie_id`) AND (`movie_info7566`.`movie_id` = `movie_keyword9696`.`movie_id` AND (`movie_info7566`.`movie_id` = `movie_companies10449`.`movie_id` AND `movie_info_idx6672`.`movie_id` = `movie_keyword9696`.`movie_id`)) AND (`movie_info_idx6672`.`movie_id` = `movie_companies10449`.`movie_id` AND (`movie_keyword9696`.`movie_id` = `movie_companies10449`.`movie_id` AND `name6488`.`id` = `cast_info7100`.`person_id`) AND (`info_type14395`.`id` = `movie_info7566`.`info_type_id` AND `info_type14396`.`id` = `movie_info_idx6672`.`info_type_id` AND (`keyword9696`.`id` = `movie_keyword9696`.`keyword_id` AND `company_name9633`.`id` = `movie_companies10449`.`company_id`))))
time used(s):12.143, index: 78, origin_cost: 851200.375, rewrite_cost: 851200.375, origin: SELECT MIN(lt.link) AS link_type, MIN(t1.title) AS first_movie, MIN(t2.title) AS second_movie FROM keyword AS k, link_type AS lt, movie_keyword AS mk, movie_link AS ml, title AS t1, title AS t2 WHERE k.keyword ='10,000-mile-club' AND mk.keyword_id = k.id AND t1.id = mk.movie_id AND ml.movie_id = t1.id AND ml.linked_movie_id = t2.id AND lt.id = ml.link_type_id AND mk.movie_id = t1.id;, rewrite: SELECT MIN(lt.link) AS link_type, MIN(t1.title) AS first_movie, MIN(t2.title) AS second_movie FROM keyword AS k, link_type AS lt, movie_keyword AS mk, movie_link AS ml, title AS t1, title AS t2 WHERE k.keyword ='10,000-mile-club' AND mk.keyword_id = k.id AND t1.id = mk.movie_id AND ml.movie_id = t1.id AND ml.linked_movie_id = t2.id AND lt.id = ml.link_type_id AND mk.movie_id = t1.id;
time used(s):14.349, index: 79, origin_cost: 851200.375, rewrite_cost: 851200.375, origin: SELECT MIN(lt.link) AS link_type, MIN(t1.title) AS first_movie, MIN(t2.title) AS second_movie FROM keyword AS k, link_type AS lt, movie_keyword AS mk, movie_link AS ml, title AS t1, title AS t2 WHERE k.keyword ='character-name-in-title' AND mk.keyword_id = k.id AND t1.id = mk.movie_id AND ml.movie_id = t1.id AND ml.linked_movie_id = t2.id AND lt.id = ml.link_type_id AND mk.movie_id = t1.id;, rewrite: SELECT MIN(lt.link) AS link_type, MIN(t1.title) AS first_movie, MIN(t2.title) AS second_movie FROM keyword AS k, link_type AS lt, movie_keyword AS mk, movie_link AS ml, title AS t1, title AS t2 WHERE k.keyword ='character-name-in-title' AND mk.keyword_id = k.id AND t1.id = mk.movie_id AND ml.movie_id = t1.id AND ml.linked_movie_id = t2.id AND lt.id = ml.link_type_id AND mk.movie_id = t1.id;
time used(s):14.755, index: 80, origin_cost: 18448.69921875, rewrite_cost: 16666.23046875, origin: SELECT MIN(cn1.name) AS first_company, MIN(cn2.name) AS second_company, MIN(mi_idx1.info) AS first_rating, MIN(mi_idx2.info) AS second_rating, MIN(t1.title) AS first_movie, MIN(t2.title) AS second_movie FROM company_name AS cn1, company_name AS cn2, info_type AS it1, info_type AS it2, kind_type AS kt1, kind_type AS kt2, link_type AS lt, movie_companies AS mc1, movie_companies AS mc2, movie_info_idx AS mi_idx1, movie_info_idx AS mi_idx2, movie_link AS ml, title AS t1, title AS t2 WHERE cn1.country_code = '[us]' AND it1.info = 'rating' AND it2.info = 'rating' AND kt1.kind IN ('tv series') AND kt2.kind IN ('tv series') AND lt.link IN ('sequel', 'follows', 'followed by') AND mi_idx2.info < '3.0' AND t2.production_year BETWEEN 2005 AND 2008 AND lt.id = ml.link_type_id AND t1.id = ml.movie_id AND t2.id = ml.linked_movie_id AND it1.id = mi_idx1.info_type_id AND t1.id = mi_idx1.movie_id AND kt1.id = t1.kind_id AND cn1.id = mc1.company_id AND t1.id = mc1.movie_id AND ml.movie_id = mi_idx1.movie_id AND ml.movie_id = mc1.movie_id AND mi_idx1.movie_id = mc1.movie_id AND it2.id = mi_idx2.info_type_id AND t2.id = mi_idx2.movie_id AND kt2.id = t2.kind_id AND cn2.id = mc2.company_id AND t2.id = mc2.movie_id AND ml.linked_movie_id = mi_idx2.movie_id AND ml.linked_movie_id = mc2.movie_id AND mi_idx2.movie_id = mc2.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`company_name9938`.`name`) AS `first_company`, MIN(`company_name9939`.`name`) AS `second_company`, MIN(`movie_info_idx6977`.`info`) AS `first_rating`, MIN(`movie_info_idx6978`.`info`) AS `second_rating`, MIN(`title15176`.`title`) AS `first_movie`, MIN(`title15177`.`title`) AS `second_movie` FROM `company_name` AS `company_name9938`, `company_name` AS `company_name9939`, `info_type` AS `info_type14703`, `info_type` AS `info_type14704`, `kind_type` AS `kind_type4943`, `kind_type` AS `kind_type4944`, `link_type` AS `link_type1392`, `movie_companies` AS `movie_companies10754`, `movie_companies` AS `movie_companies10755`, `movie_info_idx` AS `movie_info_idx6977`, `movie_info_idx` AS `movie_info_idx6978`, `movie_link` AS `movie_link1392`, `title` AS `title15176`, `title` AS `title15177` WHERE `company_name9938`.`country_code` = '[us]' AND (`info_type14703`.`info` = 'rating' AND `info_type14704`.`info` = 'rating') AND (`kind_type4943`.`kind` = 'tv series' AND `kind_type4944`.`kind` = 'tv series' AND ((`link_type1392`.`link` = 'sequel' OR `link_type1392`.`link` = 'follows' OR `link_type1392`.`link` = 'followed by') AND `movie_info_idx6978`.`info` < '3.0')) AND (`title15177`.`production_year` >= 2005 AND (`title15177`.`production_year` <= 2008 AND `link_type1392`.`id` = `movie_link1392`.`link_type_id`) AND (`title15176`.`id` = `movie_link1392`.`movie_id` AND `title15177`.`id` = `movie_link1392`.`linked_movie_id` AND (`info_type14703`.`id` = `movie_info_idx6977`.`info_type_id` AND `title15176`.`id` = `movie_info_idx6977`.`movie_id`))) AND (`kind_type4943`.`id` = `title15176`.`kind_id` AND (`company_name9938`.`id` = `movie_companies10754`.`company_id` AND `title15176`.`id` = `movie_companies10754`.`movie_id`) AND (`movie_link1392`.`movie_id` = `movie_info_idx6977`.`movie_id` AND `movie_link1392`.`movie_id` = `movie_companies10754`.`movie_id` AND (`movie_info_idx6977`.`movie_id` = `movie_companies10754`.`movie_id` AND `info_type14704`.`id` = `movie_info_idx6978`.`info_type_id`)) AND (`title15177`.`id` = `movie_info_idx6978`.`movie_id` AND (`kind_type4944`.`id` = `title15177`.`kind_id` AND `company_name9939`.`id` = `movie_companies10755`.`company_id`) AND (`title15177`.`id` = `movie_companies10755`.`movie_id` AND `movie_link1392`.`linked_movie_id` = `movie_info_idx6978`.`movie_id` AND (`movie_link1392`.`linked_movie_id` = `movie_companies10755`.`movie_id` AND `movie_info_idx6978`.`movie_id` = `movie_companies10755`.`movie_id`))))
time used(s):19.906, index: 81, origin_cost: 6838.08984375, rewrite_cost: 6838.08984375, origin: SELECT MIN(cn1.name) AS first_company, MIN(cn2.name) AS second_company, MIN(mi_idx1.info) AS first_rating, MIN(mi_idx2.info) AS second_rating, MIN(t1.title) AS first_movie, MIN(t2.title) AS second_movie FROM company_name AS cn1, company_name AS cn2, info_type AS it1, info_type AS it2, kind_type AS kt1, kind_type AS kt2, link_type AS lt, movie_companies AS mc1, movie_companies AS mc2, movie_info_idx AS mi_idx1, movie_info_idx AS mi_idx2, movie_link AS ml, title AS t1, title AS t2 WHERE cn1.country_code = '[nl]' AND it1.info = 'rating' AND it2.info = 'rating' AND kt1.kind IN ('tv series') AND kt2.kind IN ('tv series') AND lt.link LIKE '%follow%' AND mi_idx2.info < '3.0' AND t2.production_year = 2007 AND lt.id = ml.link_type_id AND t1.id = ml.movie_id AND t2.id = ml.linked_movie_id AND it1.id = mi_idx1.info_type_id AND t1.id = mi_idx1.movie_id AND kt1.id = t1.kind_id AND cn1.id = mc1.company_id AND t1.id = mc1.movie_id AND ml.movie_id = mi_idx1.movie_id AND ml.movie_id = mc1.movie_id AND mi_idx1.movie_id = mc1.movie_id AND it2.id = mi_idx2.info_type_id AND t2.id = mi_idx2.movie_id AND kt2.id = t2.kind_id AND cn2.id = mc2.company_id AND t2.id = mc2.movie_id AND ml.linked_movie_id = mi_idx2.movie_id AND ml.linked_movie_id = mc2.movie_id AND mi_idx2.movie_id = mc2.movie_id;, rewrite: SELECT MIN(cn1.name) AS first_company, MIN(cn2.name) AS second_company, MIN(mi_idx1.info) AS first_rating, MIN(mi_idx2.info) AS second_rating, MIN(t1.title) AS first_movie, MIN(t2.title) AS second_movie FROM company_name AS cn1, company_name AS cn2, info_type AS it1, info_type AS it2, kind_type AS kt1, kind_type AS kt2, link_type AS lt, movie_companies AS mc1, movie_companies AS mc2, movie_info_idx AS mi_idx1, movie_info_idx AS mi_idx2, movie_link AS ml, title AS t1, title AS t2 WHERE cn1.country_code = '[nl]' AND it1.info = 'rating' AND it2.info = 'rating' AND kt1.kind IN ('tv series') AND kt2.kind IN ('tv series') AND lt.link LIKE '%follow%' AND mi_idx2.info < '3.0' AND t2.production_year = 2007 AND lt.id = ml.link_type_id AND t1.id = ml.movie_id AND t2.id = ml.linked_movie_id AND it1.id = mi_idx1.info_type_id AND t1.id = mi_idx1.movie_id AND kt1.id = t1.kind_id AND cn1.id = mc1.company_id AND t1.id = mc1.movie_id AND ml.movie_id = mi_idx1.movie_id AND ml.movie_id = mc1.movie_id AND mi_idx1.movie_id = mc1.movie_id AND it2.id = mi_idx2.info_type_id AND t2.id = mi_idx2.movie_id AND kt2.id = t2.kind_id AND cn2.id = mc2.company_id AND t2.id = mc2.movie_id AND ml.linked_movie_id = mi_idx2.movie_id AND ml.linked_movie_id = mc2.movie_id AND mi_idx2.movie_id = mc2.movie_id;
time used(s):42.715, index: 82, origin_cost: 25983.169921875, rewrite_cost: 25982.970703125, origin: SELECT MIN(cn1.name) AS first_company, MIN(cn2.name) AS second_company, MIN(mi_idx1.info) AS first_rating, MIN(mi_idx2.info) AS second_rating, MIN(t1.title) AS first_movie, MIN(t2.title) AS second_movie FROM company_name AS cn1, company_name AS cn2, info_type AS it1, info_type AS it2, kind_type AS kt1, kind_type AS kt2, link_type AS lt, movie_companies AS mc1, movie_companies AS mc2, movie_info_idx AS mi_idx1, movie_info_idx AS mi_idx2, movie_link AS ml, title AS t1, title AS t2 WHERE cn1.country_code != '[us]' AND it1.info = 'rating' AND it2.info = 'rating' AND kt1.kind IN ('tv series', 'episode') AND kt2.kind IN ('tv series', 'episode') AND lt.link IN ('sequel', 'follows', 'followed by') AND mi_idx2.info < '3.5' AND t2.production_year BETWEEN 2000 AND 2010 AND lt.id = ml.link_type_id AND t1.id = ml.movie_id AND t2.id = ml.linked_movie_id AND it1.id = mi_idx1.info_type_id AND t1.id = mi_idx1.movie_id AND kt1.id = t1.kind_id AND cn1.id = mc1.company_id AND t1.id = mc1.movie_id AND ml.movie_id = mi_idx1.movie_id AND ml.movie_id = mc1.movie_id AND mi_idx1.movie_id = mc1.movie_id AND it2.id = mi_idx2.info_type_id AND t2.id = mi_idx2.movie_id AND kt2.id = t2.kind_id AND cn2.id = mc2.company_id AND t2.id = mc2.movie_id AND ml.linked_movie_id = mi_idx2.movie_id AND ml.linked_movie_id = mc2.movie_id AND mi_idx2.movie_id = mc2.movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`t65371`.`name`) AS `first_company`, MIN(`company_name10757`.`name`) AS `second_company`, MIN(`movie_info_idx7795`.`info`) AS `first_rating`, MIN(`t65377`.`info`) AS `second_rating`, MIN(`title15994`.`title`) AS `first_movie`, MIN(`t65378`.`title`) AS `second_movie` FROM (SELECT * FROM `company_name` WHERE `country_code` <> '[us]') AS `t65371` CROSS JOIN `company_name` AS `company_name10757` CROSS JOIN (SELECT * FROM `info_type` WHERE `info` = 'rating') AS `t65372` CROSS JOIN (SELECT * FROM `info_type` WHERE `info` = 'rating') AS `t65373` CROSS JOIN (SELECT * FROM `kind_type` WHERE `kind` IN ('episode', 'tv series')) AS `t65374` CROSS JOIN (SELECT * FROM `kind_type` WHERE `kind` IN ('episode', 'tv series')) AS `t65375` CROSS JOIN (SELECT * FROM `link_type` WHERE `link` IN ('followed by', 'follows', 'sequel')) AS `t65376` INNER JOIN `movie_companies` AS `movie_companies11572` ON `t65371`.`id` = `movie_companies11572`.`company_id` INNER JOIN `movie_companies` AS `movie_companies11573` ON `company_name10757`.`id` = `movie_companies11573`.`company_id` INNER JOIN `movie_info_idx` AS `movie_info_idx7795` ON `t65372`.`id` = `movie_info_idx7795`.`info_type_id` AND `movie_companies11572`.`movie_id` = `movie_info_idx7795`.`movie_id` INNER JOIN (SELECT * FROM `movie_info_idx` WHERE `info` < '3.5') AS `t65377` ON `t65373`.`id` = `t65377`.`info_type_id` AND `movie_companies11573`.`movie_id` = `t65377`.`movie_id` INNER JOIN `movie_link` AS `movie_link1801` ON `t65376`.`id` = `movie_link1801`.`link_type_id` AND `movie_info_idx7795`.`movie_id` = `movie_link1801`.`movie_id` AND `movie_companies11572`.`movie_id` = `movie_link1801`.`movie_id` AND `t65377`.`movie_id` = `movie_link1801`.`linked_movie_id` AND `movie_companies11573`.`movie_id` = `movie_link1801`.`linked_movie_id` INNER JOIN `title` AS `title15994` ON `movie_link1801`.`movie_id` = `title15994`.`id` AND `movie_info_idx7795`.`movie_id` = `title15994`.`id` AND `t65374`.`id` = `title15994`.`kind_id` AND `movie_companies11572`.`movie_id` = `title15994`.`id` INNER JOIN (SELECT * FROM `title` WHERE `production_year` >= 2000 AND `production_year` <= 2010) AS `t65378` ON `movie_link1801`.`linked_movie_id` = `t65378`.`id` AND `t65377`.`movie_id` = `t65378`.`id` AND `t65375`.`id` = `t65378`.`kind_id` AND `movie_companies11573`.`movie_id` = `t65378`.`id`
time used(s):13.78, index: 83, origin_cost: 1992276.0, rewrite_cost: 1992276.0, origin: SELECT MIN(t.title) AS movie_title FROM keyword AS k, movie_info AS mi, movie_keyword AS mk, title AS t WHERE k.keyword LIKE '%sequel%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German') AND t.production_year > 2005 AND t.id = mi.movie_id AND t.id = mk.movie_id AND mk.movie_id = mi.movie_id AND k.id = mk.keyword_id;, rewrite: SELECT MIN(t.title) AS movie_title FROM keyword AS k, movie_info AS mi, movie_keyword AS mk, title AS t WHERE k.keyword LIKE '%sequel%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German') AND t.production_year > 2005 AND t.id = mi.movie_id AND t.id = mk.movie_id AND mk.movie_id = mi.movie_id AND k.id = mk.keyword_id;
time used(s):13.098, index: 84, origin_cost: 1992276.0, rewrite_cost: 1992276.0, origin: SELECT MIN(t.title) AS movie_title FROM keyword AS k, movie_info AS mi, movie_keyword AS mk, title AS t WHERE k.keyword LIKE '%sequel%' AND mi.info IN ('Bulgaria') AND t.production_year > 2010 AND t.id = mi.movie_id AND t.id = mk.movie_id AND mk.movie_id = mi.movie_id AND k.id = mk.keyword_id;, rewrite: SELECT MIN(t.title) AS movie_title FROM keyword AS k, movie_info AS mi, movie_keyword AS mk, title AS t WHERE k.keyword LIKE '%sequel%' AND mi.info IN ('Bulgaria') AND t.production_year > 2010 AND t.id = mi.movie_id AND t.id = mk.movie_id AND mk.movie_id = mi.movie_id AND k.id = mk.keyword_id;
time used(s):13.957, index: 85, origin_cost: 1992276.0, rewrite_cost: 1992276.0, origin: SELECT MIN(t.title) AS movie_title FROM keyword AS k, movie_info AS mi, movie_keyword AS mk, title AS t WHERE k.keyword LIKE '%sequel%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American') AND t.production_year > 1990 AND t.id = mi.movie_id AND t.id = mk.movie_id AND mk.movie_id = mi.movie_id AND k.id = mk.keyword_id;, rewrite: SELECT MIN(t.title) AS movie_title FROM keyword AS k, movie_info AS mi, movie_keyword AS mk, title AS t WHERE k.keyword LIKE '%sequel%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American') AND t.production_year > 1990 AND t.id = mi.movie_id AND t.id = mk.movie_id AND mk.movie_id = mi.movie_id AND k.id = mk.keyword_id;
time used(s):14.597, index: 86, origin_cost: 1256140.75, rewrite_cost: 1256140.75, origin: SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS movie_title FROM info_type AS it, keyword AS k, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it.info ='rating' AND k.keyword LIKE '%sequel%' AND mi_idx.info > '5.0' AND t.production_year > 2005 AND t.id = mi_idx.movie_id AND t.id = mk.movie_id AND mk.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it.id = mi_idx.info_type_id;, rewrite: SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS movie_title FROM info_type AS it, keyword AS k, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it.info ='rating' AND k.keyword LIKE '%sequel%' AND mi_idx.info > '5.0' AND t.production_year > 2005 AND t.id = mi_idx.movie_id AND t.id = mk.movie_id AND mk.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it.id = mi_idx.info_type_id;
time used(s):14.234, index: 87, origin_cost: 1256140.75, rewrite_cost: 1256140.75, origin: SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS movie_title FROM info_type AS it, keyword AS k, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it.info ='rating' AND k.keyword LIKE '%sequel%' AND mi_idx.info > '9.0' AND t.production_year > 2010 AND t.id = mi_idx.movie_id AND t.id = mk.movie_id AND mk.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it.id = mi_idx.info_type_id;, rewrite: SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS movie_title FROM info_type AS it, keyword AS k, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it.info ='rating' AND k.keyword LIKE '%sequel%' AND mi_idx.info > '9.0' AND t.production_year > 2010 AND t.id = mi_idx.movie_id AND t.id = mk.movie_id AND mk.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it.id = mi_idx.info_type_id;
time used(s):14.036, index: 88, origin_cost: 1256140.75, rewrite_cost: 1256140.75, origin: SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS movie_title FROM info_type AS it, keyword AS k, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it.info ='rating' AND k.keyword LIKE '%sequel%' AND mi_idx.info > '2.0' AND t.production_year > 1990 AND t.id = mi_idx.movie_id AND t.id = mk.movie_id AND mk.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it.id = mi_idx.info_type_id;, rewrite: SELECT MIN(mi_idx.info) AS rating, MIN(t.title) AS movie_title FROM info_type AS it, keyword AS k, movie_info_idx AS mi_idx, movie_keyword AS mk, title AS t WHERE it.info ='rating' AND k.keyword LIKE '%sequel%' AND mi_idx.info > '2.0' AND t.production_year > 1990 AND t.id = mi_idx.movie_id AND t.id = mk.movie_id AND mk.movie_id = mi_idx.movie_id AND k.id = mk.keyword_id AND it.id = mi_idx.info_type_id;
time used(s):14.065, index: 89, origin_cost: 661970.75, rewrite_cost: 661970.75, origin: SELECT MIN(t.title) AS typical_european_movie FROM company_type AS ct, info_type AS it, movie_companies AS mc, movie_info AS mi, title AS t WHERE ct.kind = 'production companies' AND mc.note LIKE '%(theatrical)%' AND mc.note LIKE '%(France)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German') AND t.production_year > 2005 AND t.id = mi.movie_id AND t.id = mc.movie_id AND mc.movie_id = mi.movie_id AND ct.id = mc.company_type_id AND it.id = mi.info_type_id;, rewrite: SELECT MIN(t.title) AS typical_european_movie FROM company_type AS ct, info_type AS it, movie_companies AS mc, movie_info AS mi, title AS t WHERE ct.kind = 'production companies' AND mc.note LIKE '%(theatrical)%' AND mc.note LIKE '%(France)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German') AND t.production_year > 2005 AND t.id = mi.movie_id AND t.id = mc.movie_id AND mc.movie_id = mi.movie_id AND ct.id = mc.company_type_id AND it.id = mi.info_type_id;
time used(s):13.201, index: 90, origin_cost: 540712.75, rewrite_cost: 540641.9375, origin: SELECT MIN(t.title) AS american_vhs_movie FROM company_type AS ct, info_type AS it, movie_companies AS mc, movie_info AS mi, title AS t WHERE ct.kind = 'production companies' AND mc.note LIKE '%(VHS)%' AND mc.note LIKE '%(USA)%' AND mc.note LIKE '%(1994)%' AND mi.info IN ('USA', 'America') AND t.production_year > 2010 AND t.id = mi.movie_id AND t.id = mc.movie_id AND mc.movie_id = mi.movie_id AND ct.id = mc.company_type_id AND it.id = mi.info_type_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`title17579`.`title`) AS `american_vhs_movie` FROM `company_type` AS `company_type6036`, `info_type` AS `info_type16494`, `movie_companies` AS `movie_companies11933`, `movie_info` AS `movie_info8538`, `title` AS `title17579` WHERE `company_type6036`.`kind` = 'production companies' AND `movie_companies11933`.`note` LIKE '%(VHS)%' AND (`movie_companies11933`.`note` LIKE '%(USA)%' AND (`movie_companies11933`.`note` LIKE '%(1994)%' AND (`movie_info8538`.`info` = 'USA' OR `movie_info8538`.`info` = 'America'))) AND (`title17579`.`production_year` > 2010 AND (`title17579`.`id` = `movie_info8538`.`movie_id` AND `title17579`.`id` = `movie_companies11933`.`movie_id`) AND (`movie_companies11933`.`movie_id` = `movie_info8538`.`movie_id` AND (`company_type6036`.`id` = `movie_companies11933`.`company_type_id` AND `info_type16494`.`id` = `movie_info8538`.`info_type_id`)))
time used(s):14.813, index: 91, origin_cost: 1600252.375, rewrite_cost: 1600252.375, origin: SELECT MIN(t.title) AS american_movie FROM company_type AS ct, info_type AS it, movie_companies AS mc, movie_info AS mi, title AS t WHERE ct.kind = 'production companies' AND mc.note NOT LIKE '%(TV)%' AND mc.note LIKE '%(USA)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American') AND t.production_year > 1990 AND t.id = mi.movie_id AND t.id = mc.movie_id AND mc.movie_id = mi.movie_id AND ct.id = mc.company_type_id AND it.id = mi.info_type_id;, rewrite: SELECT MIN(t.title) AS american_movie FROM company_type AS ct, info_type AS it, movie_companies AS mc, movie_info AS mi, title AS t WHERE ct.kind = 'production companies' AND mc.note NOT LIKE '%(TV)%' AND mc.note LIKE '%(USA)%' AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American') AND t.production_year > 1990 AND t.id = mi.movie_id AND t.id = mc.movie_id AND mc.movie_id = mi.movie_id AND ct.id = mc.company_type_id AND it.id = mi.info_type_id;
time used(s):15.34, index: 92, origin_cost: 7188399.0, rewrite_cost: 7188399.0, origin: SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS marvel_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword = 'marvel-cinematic-universe' AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2010 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;, rewrite: SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS marvel_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword = 'marvel-cinematic-universe' AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2010 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;
time used(s):14.044, index: 93, origin_cost: 3.5829328E7, rewrite_cost: 3.5829328E7, origin: SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS hero_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2014 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;, rewrite: SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS hero_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2014 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;
time used(s):13.602, index: 94, origin_cost: 7188399.0, rewrite_cost: 7188399.0, origin: SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS marvel_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword = 'marvel-cinematic-universe' AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2014 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;, rewrite: SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS marvel_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword = 'marvel-cinematic-universe' AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2014 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;
time used(s):13.999, index: 95, origin_cost: 3.5829328E7, rewrite_cost: 3.5829328E7, origin: SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS hero_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2000 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;, rewrite: SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS hero_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2000 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;
time used(s):14.096, index: 96, origin_cost: 7188399.0, rewrite_cost: 7188399.0, origin: SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS marvel_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword = 'marvel-cinematic-universe' AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2000 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;, rewrite: SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS marvel_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword = 'marvel-cinematic-universe' AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2000 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;
time used(s):14.212, index: 97, origin_cost: 3.5829328E7, rewrite_cost: 3.5829328E7, origin: SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS hero_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND t.production_year > 2000 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;, rewrite: SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS hero_movie FROM cast_info AS ci, keyword AS k, movie_keyword AS mk, name AS n, title AS t WHERE k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND t.production_year > 2000 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id;
time used(s):23.694, index: 98, origin_cost: 23910.560546875, rewrite_cost: 23908.69921875, origin: SELECT MIN(n.name) AS of_person, MIN(t.title) AS biography_movie FROM aka_name AS an, cast_info AS ci, info_type AS it, link_type AS lt, movie_link AS ml, name AS n, person_info AS pi, title AS t WHERE an.name LIKE '%a%' AND it.info ='mini biography' AND lt.link ='features' AND n.name_pcode_cf BETWEEN 'A' AND 'F' AND (n.gender='m' OR (n.gender = 'f' AND n.name LIKE 'B%')) AND pi.note ='Volker Boehm' AND t.production_year BETWEEN 1980 AND 1995 AND n.id = an.person_id AND n.id = pi.person_id AND ci.person_id = n.id AND t.id = ci.movie_id AND ml.linked_movie_id = t.id AND lt.id = ml.link_type_id AND it.id = pi.info_type_id AND pi.person_id = an.person_id AND pi.person_id = ci.person_id AND an.person_id = ci.person_id AND ci.movie_id = ml.linked_movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`t75888`.`name`) AS `of_person`, MIN(`t75890`.`title`) AS `biography_movie` FROM (SELECT * FROM `aka_name` WHERE `name` LIKE '%a%') AS `t75885` INNER JOIN `cast_info` AS `cast_info8397` ON `t75885`.`person_id` = `cast_info8397`.`person_id` CROSS JOIN (SELECT * FROM `info_type` WHERE `info` = 'mini biography') AS `t75886` CROSS JOIN (SELECT * FROM `link_type` WHERE `link` = 'features') AS `t75887` INNER JOIN `movie_link` AS `movie_link1873` ON `t75887`.`id` = `movie_link1873`.`link_type_id` AND `cast_info8397`.`movie_id` = `movie_link1873`.`linked_movie_id` INNER JOIN (SELECT * FROM `name` WHERE `name_pcode_cf` >= 'A' AND `name_pcode_cf` <= 'F' AND (`gender` = 'm' OR `gender` = 'f' AND `name` LIKE 'B%')) AS `t75888` ON `t75885`.`person_id` = `t75888`.`id` AND `cast_info8397`.`person_id` = `t75888`.`id` INNER JOIN (SELECT * FROM `person_info` WHERE `note` = 'Volker Boehm') AS `t75889` ON `t75888`.`id` = `t75889`.`person_id` AND `t75886`.`id` = `t75889`.`info_type_id` AND `t75885`.`person_id` = `t75889`.`person_id` AND `cast_info8397`.`person_id` = `t75889`.`person_id` INNER JOIN (SELECT * FROM `title` WHERE `production_year` >= 1980 AND `production_year` <= 1995) AS `t75890` ON `cast_info8397`.`movie_id` = `t75890`.`id` AND `movie_link1873`.`linked_movie_id` = `t75890`.`id`
time used(s):23.775, index: 99, origin_cost: 23910.560546875, rewrite_cost: 23908.69921875, origin: SELECT MIN(n.name) AS of_person, MIN(t.title) AS biography_movie FROM aka_name AS an, cast_info AS ci, info_type AS it, link_type AS lt, movie_link AS ml, name AS n, person_info AS pi, title AS t WHERE an.name LIKE '%a%' AND it.info ='mini biography' AND lt.link ='features' AND n.name_pcode_cf LIKE 'D%' AND n.gender='m' AND pi.note ='Volker Boehm' AND t.production_year BETWEEN 1980 AND 1984 AND n.id = an.person_id AND n.id = pi.person_id AND ci.person_id = n.id AND t.id = ci.movie_id AND ml.linked_movie_id = t.id AND lt.id = ml.link_type_id AND it.id = pi.info_type_id AND pi.person_id = an.person_id AND pi.person_id = ci.person_id AND an.person_id = ci.person_id AND ci.movie_id = ml.linked_movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`t76978`.`name`) AS `of_person`, MIN(`t76980`.`title`) AS `biography_movie` FROM (SELECT * FROM `aka_name` WHERE `name` LIKE '%a%') AS `t76975` INNER JOIN `cast_info` AS `cast_info8557` ON `t76975`.`person_id` = `cast_info8557`.`person_id` CROSS JOIN (SELECT * FROM `info_type` WHERE `info` = 'mini biography') AS `t76976` CROSS JOIN (SELECT * FROM `link_type` WHERE `link` = 'features') AS `t76977` INNER JOIN `movie_link` AS `movie_link2033` ON `t76977`.`id` = `movie_link2033`.`link_type_id` AND `cast_info8557`.`movie_id` = `movie_link2033`.`linked_movie_id` INNER JOIN (SELECT * FROM `name` WHERE `name_pcode_cf` LIKE 'D%' AND `gender` = 'm') AS `t76978` ON `t76975`.`person_id` = `t76978`.`id` AND `cast_info8557`.`person_id` = `t76978`.`id` INNER JOIN (SELECT * FROM `person_info` WHERE `note` = 'Volker Boehm') AS `t76979` ON `t76978`.`id` = `t76979`.`person_id` AND `t76976`.`id` = `t76979`.`info_type_id` AND `t76975`.`person_id` = `t76979`.`person_id` AND `cast_info8557`.`person_id` = `t76979`.`person_id` INNER JOIN (SELECT * FROM `title` WHERE `production_year` >= 1980 AND `production_year` <= 1984) AS `t76980` ON `cast_info8557`.`movie_id` = `t76980`.`id` AND `movie_link2033`.`linked_movie_id` = `t76980`.`id`
time used(s):12.637, index: 100, origin_cost: 98899.84375, rewrite_cost: 85023.1015625, origin: SELECT MIN(n.name) AS cast_member_name, MIN(pi.info) AS cast_member_info FROM aka_name AS an, cast_info AS ci, info_type AS it, link_type AS lt, movie_link AS ml, name AS n, person_info AS pi, title AS t WHERE an.name IS NOT NULL AND (an.name LIKE '%a%' OR an.name LIKE 'A%') AND it.info ='mini biography' AND lt.link IN ('references', 'referenced in', 'features', 'featured in') AND n.name_pcode_cf BETWEEN 'A' AND 'F' AND (n.gender='m' OR (n.gender = 'f' AND n.name LIKE 'A%')) AND pi.note IS NOT NULL AND t.production_year BETWEEN 1980 AND 2010 AND n.id = an.person_id AND n.id = pi.person_id AND ci.person_id = n.id AND t.id = ci.movie_id AND ml.linked_movie_id = t.id AND lt.id = ml.link_type_id AND it.id = pi.info_type_id AND pi.person_id = an.person_id AND pi.person_id = ci.person_id AND an.person_id = ci.person_id AND ci.movie_id = ml.linked_movie_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`name8138`.`name`) AS `cast_member_name`, MIN(`person_info890`.`info`) AS `cast_member_info` FROM `aka_name` AS `aka_name2686`, `cast_info` AS `cast_info8750`, `info_type` AS `info_type17122`, `link_type` AS `link_type2226`, `movie_link` AS `movie_link2226`, `name` AS `name8138`, `person_info` AS `person_info890`, `title` AS `title19431` WHERE `aka_name2686`.`name` IS NOT NULL AND (`aka_name2686`.`name` LIKE '%a%' OR `aka_name2686`.`name` LIKE 'A%') AND (`info_type17122`.`info` = 'mini biography' AND ((`link_type2226`.`link` = 'references' OR `link_type2226`.`link` = 'referenced in' OR `link_type2226`.`link` = 'features' OR `link_type2226`.`link` = 'featured in') AND `name8138`.`name_pcode_cf` >= 'A')) AND (`name8138`.`name_pcode_cf` <= 'F' AND (`name8138`.`gender` = 'm' OR `name8138`.`gender` = 'f' AND `name8138`.`name` LIKE 'A%') AND (`person_info890`.`note` IS NOT NULL AND (`title19431`.`production_year` >= 1980 AND `title19431`.`production_year` <= 2010))) AND (`name8138`.`id` = `aka_name2686`.`person_id` AND `name8138`.`id` = `person_info890`.`person_id` AND (`cast_info8750`.`person_id` = `name8138`.`id` AND (`title19431`.`id` = `cast_info8750`.`movie_id` AND `movie_link2226`.`linked_movie_id` = `title19431`.`id`)) AND (`link_type2226`.`id` = `movie_link2226`.`link_type_id` AND (`info_type17122`.`id` = `person_info890`.`info_type_id` AND `person_info890`.`person_id` = `aka_name2686`.`person_id`) AND (`person_info890`.`person_id` = `cast_info8750`.`person_id` AND (`aka_name2686`.`person_id` = `cast_info8750`.`person_id` AND `cast_info8750`.`movie_id` = `movie_link2226`.`linked_movie_id`))))
time used(s):15.791, index: 101, origin_cost: 8943.1396484375, rewrite_cost: 8943.1396484375, origin: SELECT MIN(an1.name) AS actress_pseudonym, MIN(t.title) AS japanese_movie_dubbed FROM aka_name AS an1, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n1, role_type AS rt, title AS t WHERE ci.note ='(voice: English version)' AND cn.country_code ='[jp]' AND mc.note LIKE '%(Japan)%' AND mc.note NOT LIKE '%(USA)%' AND n1.name LIKE '%Yo%' AND n1.name NOT LIKE '%Yu%' AND rt.role ='actress' AND an1.person_id = n1.id AND n1.id = ci.person_id AND ci.movie_id = t.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND an1.person_id = ci.person_id AND ci.movie_id = mc.movie_id;, rewrite: SELECT MIN(an1.name) AS actress_pseudonym, MIN(t.title) AS japanese_movie_dubbed FROM aka_name AS an1, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n1, role_type AS rt, title AS t WHERE ci.note ='(voice: English version)' AND cn.country_code ='[jp]' AND mc.note LIKE '%(Japan)%' AND mc.note NOT LIKE '%(USA)%' AND n1.name LIKE '%Yo%' AND n1.name NOT LIKE '%Yu%' AND rt.role ='actress' AND an1.person_id = n1.id AND n1.id = ci.person_id AND ci.movie_id = t.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND an1.person_id = ci.person_id AND ci.movie_id = mc.movie_id;
time used(s):16.014, index: 102, origin_cost: 8063.35986328125, rewrite_cost: 8063.35986328125, origin: SELECT MIN(an.name) AS acress_pseudonym, MIN(t.title) AS japanese_anime_movie FROM aka_name AS an, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n, role_type AS rt, title AS t WHERE ci.note ='(voice: English version)' AND cn.country_code ='[jp]' AND mc.note LIKE '%(Japan)%' AND mc.note NOT LIKE '%(USA)%' AND (mc.note LIKE '%(2006)%' OR mc.note LIKE '%(2007)%') AND n.name LIKE '%Yo%' AND n.name NOT LIKE '%Yu%' AND rt.role ='actress' AND t.production_year BETWEEN 2006 AND 2007 AND (t.title LIKE 'One Piece%' OR t.title LIKE 'Dragon Ball Z%') AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id;, rewrite: SELECT MIN(an.name) AS acress_pseudonym, MIN(t.title) AS japanese_anime_movie FROM aka_name AS an, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n, role_type AS rt, title AS t WHERE ci.note ='(voice: English version)' AND cn.country_code ='[jp]' AND mc.note LIKE '%(Japan)%' AND mc.note NOT LIKE '%(USA)%' AND (mc.note LIKE '%(2006)%' OR mc.note LIKE '%(2007)%') AND n.name LIKE '%Yo%' AND n.name NOT LIKE '%Yu%' AND rt.role ='actress' AND t.production_year BETWEEN 2006 AND 2007 AND (t.title LIKE 'One Piece%' OR t.title LIKE 'Dragon Ball Z%') AND an.person_id = n.id AND n.id = ci.person_id AND ci.movie_id = t.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND an.person_id = ci.person_id AND ci.movie_id = mc.movie_id;
time used(s):17.319, index: 103, origin_cost: 78889.796875, rewrite_cost: 78889.796875, origin: SELECT MIN(a1.name) AS writer_pseudo_name, MIN(t.title) AS movie_title FROM aka_name AS a1, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n1, role_type AS rt, title AS t WHERE cn.country_code ='[us]' AND rt.role ='writer' AND a1.person_id = n1.id AND n1.id = ci.person_id AND ci.movie_id = t.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND a1.person_id = ci.person_id AND ci.movie_id = mc.movie_id;, rewrite: SELECT MIN(a1.name) AS writer_pseudo_name, MIN(t.title) AS movie_title FROM aka_name AS a1, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n1, role_type AS rt, title AS t WHERE cn.country_code ='[us]' AND rt.role ='writer' AND a1.person_id = n1.id AND n1.id = ci.person_id AND ci.movie_id = t.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND a1.person_id = ci.person_id AND ci.movie_id = mc.movie_id;
time used(s):16.618, index: 104, origin_cost: 78889.796875, rewrite_cost: 78889.796875, origin: SELECT MIN(an1.name) AS costume_designer_pseudo, MIN(t.title) AS movie_with_costumes FROM aka_name AS an1, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n1, role_type AS rt, title AS t WHERE cn.country_code ='[us]' AND rt.role ='costume designer' AND an1.person_id = n1.id AND n1.id = ci.person_id AND ci.movie_id = t.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND an1.person_id = ci.person_id AND ci.movie_id = mc.movie_id;, rewrite: SELECT MIN(an1.name) AS costume_designer_pseudo, MIN(t.title) AS movie_with_costumes FROM aka_name AS an1, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n1, role_type AS rt, title AS t WHERE cn.country_code ='[us]' AND rt.role ='costume designer' AND an1.person_id = n1.id AND n1.id = ci.person_id AND ci.movie_id = t.id AND t.id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND an1.person_id = ci.person_id AND ci.movie_id = mc.movie_id;
time used(s):12.205, index: 105, origin_cost: 10899.599609375, rewrite_cost: 10393.2001953125, origin: SELECT MIN(an.name) AS alternative_name, MIN(chn.name) AS character_name, MIN(t.title) AS movie FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n, role_type AS rt, title AS t WHERE ci.note IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND mc.note IS NOT NULL AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%') AND n.gender ='f' AND n.name LIKE '%Ang%' AND rt.role ='actress' AND t.production_year BETWEEN 2005 AND 2015 AND ci.movie_id = t.id AND t.id = mc.movie_id AND ci.movie_id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND n.id = ci.person_id AND chn.id = ci.person_role_id AND an.person_id = n.id AND an.person_id = ci.person_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`aka_name3802`.`name`) AS `alternative_name`, MIN(`char_name3434`.`name`) AS `character_name`, MIN(`title20547`.`title`) AS `movie` FROM `aka_name` AS `aka_name3802`, `char_name` AS `char_name3434`, `cast_info` AS `cast_info9866`, `company_name` AS `company_name11727`, `movie_companies` AS `movie_companies13105`, `name` AS `name9254`, `role_type` AS `role_type3026`, `title` AS `title20547` WHERE (`cast_info9866`.`note` = '(voice)' OR `cast_info9866`.`note` = '(voice: Japanese version)' OR `cast_info9866`.`note` = '(voice) (uncredited)' OR `cast_info9866`.`note` = '(voice: English version)') AND `company_name11727`.`country_code` = '[us]' AND (`movie_companies13105`.`note` IS NOT NULL AND (`movie_companies13105`.`note` LIKE '%(USA)%' OR `movie_companies13105`.`note` LIKE '%(worldwide)%')) AND (`name9254`.`gender` = 'f' AND `name9254`.`name` LIKE '%Ang%' AND (`role_type3026`.`role` = 'actress' AND (`title20547`.`production_year` >= 2005 AND `title20547`.`production_year` <= 2015))) AND (`cast_info9866`.`movie_id` = `title20547`.`id` AND `title20547`.`id` = `movie_companies13105`.`movie_id` AND (`cast_info9866`.`movie_id` = `movie_companies13105`.`movie_id` AND `movie_companies13105`.`company_id` = `company_name11727`.`id`) AND (`cast_info9866`.`role_id` = `role_type3026`.`id` AND `name9254`.`id` = `cast_info9866`.`person_id` AND (`char_name3434`.`id` = `cast_info9866`.`person_role_id` AND (`aka_name3802`.`person_id` = `name9254`.`id` AND `aka_name3802`.`person_id` = `cast_info9866`.`person_id`))))
time used(s):26.523, index: 106, origin_cost: 8189.990234375, rewrite_cost: 8189.97021484375, origin: SELECT MIN(an.name) AS alternative_name, MIN(chn.name) AS voiced_character, MIN(n.name) AS voicing_actress, MIN(t.title) AS american_movie FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n, role_type AS rt, title AS t WHERE ci.note = '(voice)' AND cn.country_code ='[us]' AND mc.note LIKE '%(200%)%' AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%') AND n.gender ='f' AND n.name LIKE '%Angel%' AND rt.role ='actress' AND t.production_year BETWEEN 2007 AND 2010 AND ci.movie_id = t.id AND t.id = mc.movie_id AND ci.movie_id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND n.id = ci.person_id AND chn.id = ci.person_role_id AND an.person_id = n.id AND an.person_id = ci.person_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`aka_name3839`.`name`) AS `alternative_name`, MIN(`char_name3471`.`name`) AS `voiced_character`, MIN(`t82775`.`name`) AS `voicing_actress`, MIN(`t82777`.`title`) AS `american_movie` FROM `aka_name` AS `aka_name3839` CROSS JOIN `char_name` AS `char_name3471` INNER JOIN (SELECT * FROM `cast_info` WHERE `note` = '(voice)') AS `t82772` ON `char_name3471`.`id` = `t82772`.`person_role_id` AND `aka_name3839`.`person_id` = `t82772`.`person_id` CROSS JOIN (SELECT * FROM `company_name` WHERE `country_code` = '[us]') AS `t82773` INNER JOIN (SELECT * FROM `movie_companies` WHERE `note` LIKE '%(200%)%' AND (`note` LIKE '%(USA)%' OR `note` LIKE '%(worldwide)%')) AS `t82774` ON `t82772`.`movie_id` = `t82774`.`movie_id` AND `t82773`.`id` = `t82774`.`company_id` INNER JOIN (SELECT * FROM `name` WHERE `gender` = 'f' AND `name` LIKE '%Angel%') AS `t82775` ON `t82772`.`person_id` = `t82775`.`id` AND `aka_name3839`.`person_id` = `t82775`.`id` INNER JOIN (SELECT * FROM `role_type` WHERE `role` = 'actress') AS `t82776` ON `t82772`.`role_id` = `t82776`.`id` INNER JOIN (SELECT * FROM `title` WHERE `production_year` >= 2007 AND `production_year` <= 2010) AS `t82777` ON `t82772`.`movie_id` = `t82777`.`id` AND `t82774`.`movie_id` = `t82777`.`id`
time used(s):11.706, index: 107, origin_cost: 17172.9609375, rewrite_cost: 15786.7802734375, origin: SELECT MIN(an.name) AS alternative_name, MIN(chn.name) AS voiced_character_name, MIN(n.name) AS voicing_actress, MIN(t.title) AS american_movie FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n, role_type AS rt, title AS t WHERE ci.note IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND n.gender ='f' AND n.name LIKE '%An%' AND rt.role ='actress' AND ci.movie_id = t.id AND t.id = mc.movie_id AND ci.movie_id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND n.id = ci.person_id AND chn.id = ci.person_role_id AND an.person_id = n.id AND an.person_id = ci.person_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`aka_name4161`.`name`) AS `alternative_name`, MIN(`char_name3793`.`name`) AS `voiced_character_name`, MIN(`name9613`.`name`) AS `voicing_actress`, MIN(`title20906`.`title`) AS `american_movie` FROM `aka_name` AS `aka_name4161`, `char_name` AS `char_name3793`, `cast_info` AS `cast_info10225`, `company_name` AS `company_name12086`, `movie_companies` AS `movie_companies13464`, `name` AS `name9613`, `role_type` AS `role_type3385`, `title` AS `title20906` WHERE (`cast_info10225`.`note` = '(voice)' OR `cast_info10225`.`note` = '(voice: Japanese version)' OR `cast_info10225`.`note` = '(voice) (uncredited)' OR `cast_info10225`.`note` = '(voice: English version)') AND (`company_name12086`.`country_code` = '[us]' AND `name9613`.`gender` = 'f') AND (`name9613`.`name` LIKE '%An%' AND `role_type3385`.`role` = 'actress' AND (`cast_info10225`.`movie_id` = `title20906`.`id` AND `title20906`.`id` = `movie_companies13464`.`movie_id`)) AND (`cast_info10225`.`movie_id` = `movie_companies13464`.`movie_id` AND (`movie_companies13464`.`company_id` = `company_name12086`.`id` AND `cast_info10225`.`role_id` = `role_type3385`.`id`) AND (`name9613`.`id` = `cast_info10225`.`person_id` AND `char_name3793`.`id` = `cast_info10225`.`person_role_id` AND (`aka_name4161`.`person_id` = `name9613`.`id` AND `aka_name4161`.`person_id` = `cast_info10225`.`person_id`)))
time used(s):12.466, index: 108, origin_cost: 18313.5390625, rewrite_cost: 16767.390625, origin: SELECT MIN(an.name) AS alternative_name, MIN(chn.name) AS voiced_char_name, MIN(n.name) AS voicing_actress, MIN(t.title) AS american_movie FROM aka_name AS an, char_name AS chn, cast_info AS ci, company_name AS cn, movie_companies AS mc, name AS n, role_type AS rt, title AS t WHERE ci.note IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)') AND cn.country_code ='[us]' AND n.gender ='f' AND rt.role ='actress' AND ci.movie_id = t.id AND t.id = mc.movie_id AND ci.movie_id = mc.movie_id AND mc.company_id = cn.id AND ci.role_id = rt.id AND n.id = ci.person_id AND chn.id = ci.person_role_id AND an.person_id = n.id AND an.person_id = ci.person_id;, rewrite: /*+ JOIN_PREFIX(kind_type, link_type, comp_cast_type, role_type, company_type, info_type, movie_link, complete_cast, keyword, company_name, aka_title, movie_info_idx, aka_name, movie_companies, movie_keyword, char_name, title, name, person_info, movie_info, cast_info) */ SELECT MIN(`aka_name4178`.`name`) AS `alternative_name`, MIN(`char_name3810`.`name`) AS `voiced_char_name`, MIN(`name9630`.`name`) AS `voicing_actress`, MIN(`title20923`.`title`) AS `american_movie` FROM `aka_name` AS `aka_name4178`, `char_name` AS `char_name3810`, `cast_info` AS `cast_info10242`, `company_name` AS `company_name12103`, `movie_companies` AS `movie_companies13481`, `name` AS `name9630`, `role_type` AS `role_type3402`, `title` AS `title20923` WHERE (`cast_info10242`.`note` = '(voice)' OR `cast_info10242`.`note` = '(voice: Japanese version)' OR `cast_info10242`.`note` = '(voice) (uncredited)' OR `cast_info10242`.`note` = '(voice: English version)') AND (`company_name12103`.`country_code` = '[us]' AND `name9630`.`gender` = 'f') AND (`role_type3402`.`role` = 'actress' AND (`cast_info10242`.`movie_id` = `title20923`.`id` AND `title20923`.`id` = `movie_companies13481`.`movie_id`)) AND (`cast_info10242`.`movie_id` = `movie_companies13481`.`movie_id` AND (`movie_companies13481`.`company_id` = `company_name12103`.`id` AND `cast_info10242`.`role_id` = `role_type3402`.`id`) AND (`name9630`.`id` = `cast_info10242`.`person_id` AND `char_name3810`.`id` = `cast_info10242`.`person_role_id` AND (`aka_name4178`.`person_id` = `name9630`.`id` AND `aka_name4178`.`person_id` = `cast_info10242`.`person_id`)))
